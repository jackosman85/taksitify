<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taksitify - Finansal Hesaplama ve Analiz Platformu</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --border-radius: 10px;
            --box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ed 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, var(--dark-color) 0%, #1a2530 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }
        
        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar-header h2 i {
            color: var(--primary-color);
        }
        
        .add-card-btn {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .add-card-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        
        .card-list {
            list-style: none;
            margin-bottom: 30px;
        }
        
        .card-item {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            padding-right: 40px;
            border-left: 4px solid transparent;
        }
        
        .card-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateX(5px);
        }
        
        .card-item.active {
            background: rgba(52, 152, 219, 0.2);
            border-left: 4px solid var(--primary-color);
        }
        
        .card-delete-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            font-size: 1rem;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .card-delete-btn:hover {
            background-color: var(--danger-color);
            color: white;
            transform: scale(1.1);
        }
        
        .finance-tools {
            margin-top: 30px;
        }
        
        .finance-tools h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: #ecf0f1;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tool-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 12px 15px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tool-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }
        
        .tool-item.active {
            background: var(--primary-color);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            background: #f5f7fa;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .header h1 {
            font-size: 1.8rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-info {
            display: flex;
            gap: 20px;
        }
        
        .info-box {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            flex: 1;
            position: relative;
            transition: var(--transition);
            border-top: 4px solid var(--primary-color);
        }
        
        .info-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .info-box h3 {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .info-box p {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--dark-color);
        }
        
        .limit-bar {
            height: 10px;
            background-color: #eee;
            border-radius: 5px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        .limit-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color) 0%, #27ae60 100%);
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .as-limit-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        .as-limit-section label {
            display: block;
            font-size: 0.8rem;
            color: #777;
            margin-bottom: 5px;
        }
        
        .as-limit-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .as-limit-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .expense-section {
            margin-top: 30px;
        }
        
        .section-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--dark-color);
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .section-title h2 {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .add-expense-form {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-bottom: 25px;
            transition: var(--transition);
        }
        
        .add-expense-form:hover {
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.2);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(52, 152, 219, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color) 0%, #c0392b 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(231, 76, 60, 0.2);
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(231, 76, 60, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #27ae60 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(46, 204, 113, 0.2);
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(46, 204, 113, 0.3);
        }
        
        .expense-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .expense-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            width: 220px;
            position: relative;
            transition: var(--transition);
            border-top: 4px solid var(--warning-color);
        }
        
        .expense-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .expense-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .expense-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--dark-color);
        }
        
        .delete-btn {
            background: none;
            border: none;
            color: var(--danger-color);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .delete-btn:hover {
            background-color: rgba(231, 76, 60, 0.1);
            border-radius: 50%;
            transform: scale(1.1);
        }
        
        .expense-details {
            margin-top: 10px;
        }
        
        .expense-details p {
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }
        
        .expense-details .label {
            color: #777;
            font-weight: 500;
        }
        
        .expense-details .value {
            color: var(--dark-color);
            font-weight: bold;
        }
        
        .months-section {
            margin-top: 30px;
        }
        
        .months-container {
            display: flex;
            overflow-x: auto;
            gap: 20px;
            padding: 15px 0;
        }
        
        .month-column {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            min-width: 220px;
            position: relative;
            transition: var(--transition);
        }
        
        .month-column:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .month-header {
            text-align: center;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            color: var(--dark-color);
            font-size: 1.1rem;
        }
        
        .month-total {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #eee;
            font-weight: bold;
            text-align: center;
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        .expense-item {
            background: #f9f9f9;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            position: relative;
            transition: var(--transition);
        }
        
        .expense-item:hover {
            background: #f0f0f0;
        }
        
        .expense-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 5px;
        }
        
        .expense-item .expense-name {
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .expense-item .expense-amount {
            font-size: 0.9rem;
            color: #e74c3c;
            font-weight: bold;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            width: 480px;
            max-width: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            transform: translateY(-20px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-header h3 {
            font-size: 1.5rem;
            color: var(--dark-color);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #777;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            background-color: rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            color: #333;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 25px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #777;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #ddd;
        }
        
        .finance-calculator {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-top: 30px;
            display: none;
        }
        
        .finance-calculator.active {
            display: block;
        }
        
        .calculator-title {
            font-size: 1.6rem;
            margin-bottom: 25px;
            color: var(--dark-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .calculator-result {
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-color);
        }
        
        .calculator-result h4 {
            margin-bottom: 15px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .useful-sites {
            margin-top: 30px;
        }
        
        .site-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .site-item {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 20px;
            border-top: 4px solid var(--primary-color);
        }
        
        .site-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.1);
        }
        
        .site-logo {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .site-content {
            flex: 1;
        }
        
        .site-item a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            font-size: 1.2rem;
            display: block;
            margin-bottom: 8px;
            transition: var(--transition);
        }
        
        .site-item a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        
        .site-description {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.5;
        }
        
        .month-navigation {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .debug-info {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: var(--border-radius);
            padding: 12px;
            margin-top: 15px;
            font-size: 13px;
            color: #666;
            font-family: monospace;
        }
        
        .card-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .expense-category {
            background-color: #e3f2fd;
            border-radius: 12px;
            padding: 4px 10px;
            font-size: 0.75rem;
            color: #1976d2;
            margin-top: 5px;
            display: inline-block;
        }
        
        .quick-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .quick-action-btn {
            flex: 1;
            padding: 10px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid #dee2e6;
            border-radius: var(--border-radius);
            cursor: pointer;
            text-align: center;
            font-size: 0.9rem;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .quick-action-btn:hover {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        /* Tool Section Styles */
        .tool-section {
            display: none;
        }
        
        .tool-section.active {
            display: block;
        }

        /* Enflasyon Tablosu */
        .inflation-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }
        
        .inflation-table th,
        .inflation-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .inflation-table th {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            font-weight: 500;
        }
        
        .inflation-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .inflation-table .tuk {
            color: #3498db;
            font-weight: bold;
        }
        
        .inflation-table .ito {
            color: #2ecc71;
            font-weight: bold;
        }
        
        .inflation-table .enag {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .chart-comparison {
            margin-top: 35px;
        }
        
        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            font-weight: 500;
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }

        /* Getiri Hesaplama Styles */
        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 25px;
        }
        
        .calculator-inputs {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .calculator-results {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
            padding-bottom: 18px;
            border-bottom: 1px solid #eee;
        }
        
        .result-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .result-label {
            font-weight: 500;
            color: #666;
        }
        
        .result-value {
            font-weight: bold;
            font-size: 1.15rem;
            color: var(--primary-color);
        }
        
        .result-highlight {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            padding: 20px;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--secondary-color);
            margin-top: 20px;
        }

        /* Yeni Getiri Hesaplama Stilleri */
        .period-selector {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .period-select {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .period-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .period-input {
            flex: 1;
        }
        
        .enag-info {
            font-size: 0.85rem;
            color: #e74c3c;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .inflation-info {
            font-size: 0.85rem;
            color: #3498db;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Getiri Grafikleri */
        .return-charts {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin-top: 35px;
        }
        
        .chart-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .chart-title {
            text-align: center;
            margin-bottom: 20px;
            color: #444;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        /* Yığılmış (Stacked) Bar Chart için özel stiller */
        .stacked-bar-legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stacked-legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            font-weight: 500;
        }

        /* Stopaj için ek stiller */
        .stopaj-section {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 1px solid #ffeaa7;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
        }
        
        .stopaj-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            cursor: pointer;
        }
        
        .stopaj-toggle input {
            width: 20px;
            height: 20px;
        }
        
        .stopaj-content {
            display: none;
            margin-top: 15px;
        }
        
        .stopaj-content.active {
            display: block;
        }
        
        .stopaj-info {
            font-size: 0.85rem;
            color: #856404;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .tax-breakdown {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #e74c3c;
        }
        
        .tax-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .tax-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .tax-label {
            font-weight: 500;
            color: #666;
        }
        
        .tax-value {
            font-weight: bold;
            color: #e74c3c;
        }
        
        .net-return {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-top: 20px;
            border-left: 4px solid var(--secondary-color);
        }

        /* Responsive Tasarım */
        @media (max-width: 1200px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }
            
            .card-info {
                flex-direction: column;
            }
        }
        
        @media (max-width: 992px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .form-row {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
                align-items: flex-start;
            }
            
            .card-info {
                width: 100%;
            }
            
            .expense-cards {
                justify-content: center;
            }
            
            .site-list {
                grid-template-columns: 1fr;
            }
            
            .month-navigation {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sol Menü - Kart Listesi ve Finansal Araçlar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-credit-card"></i> Kartlarım</h2>
                <button class="add-card-btn" id="addCardBtn">+</button>
            </div>
            <ul class="card-list" id="cardList">
                <div class="empty-state">
                    <i class="fas fa-credit-card"></i>
                    <h3>Henüz kart eklenmemiş</h3>
                    <p>Yeni bir kart eklemek için "+" butonuna tıklayın</p>
                </div>
            </ul>
            
            <div class="finance-tools">
                <h3><i class="fas fa-tools"></i> Finansal Araçlar</h3>
                <div class="tool-item active" data-tool="taksit">
                    <i class="fas fa-calculator"></i> Taksit Hesaplama
                </div>
                <div class="tool-item" data-tool="getiri">
                    <i class="fas fa-chart-line"></i> Getiri Hesaplama
                </div>
                <div class="tool-item" data-tool="monthly-budget">
                    <i class="fas fa-wallet"></i> Aylık Bütçe
                </div>
                <div class="tool-item" data-tool="inflation">
                    <i class="fas fa-chart-bar"></i> Enflasyon Verileri
                </div>
                <div class="tool-item" data-tool="useful-sites">
                    <i class="fas fa-link"></i> Yararlı Siteler
                </div>
            </div>
        </div>
        
        <!-- Ana İçerik -->
        <div class="main-content">
            <!-- Taksit Hesaplama Bölümü -->
            <div id="taksit-section" class="tool-section active">
                <div class="header">
                    <h1><i class="fas fa-credit-card"></i> <span id="currentCardName">Kart Seçin</span></h1>
                    <div class="card-info">
                        <div class="info-box">
                            <h3><i class="fas fa-money-bill-wave"></i> Kullanılabilir Limit</h3>
                            <p id="availableLimit">0 TL</p>
                            <div class="limit-bar">
                                <div class="limit-fill" id="limitFill" style="width: 0%"></div>
                            </div>
                            <div class="as-limit-section">
                                <label for="asLimitInput"><i class="fas fa-cog"></i> As Limit (TL):</label>
                                <input type="number" id="asLimitInput" class="as-limit-input" placeholder="As limit girin" value="25000">
                            </div>
                        </div>
                        <div class="info-box">
                            <h3><i class="fas fa-file-invoice-dollar"></i> Toplam Borç</h3>
                            <p id="totalDebt">0 TL</p>
                        </div>
                        <div class="info-box">
                            <h3><i class="fas fa-hand-holding-usd"></i> Asgari Ödeme</h3>
                            <p id="minPayment">0 TL</p>
                        </div>
                    </div>
                </div>
                
                <!-- Hızlı İşlemler -->
                <div class="quick-actions">
                    <button class="quick-action-btn" data-amount="500">500 TL</button>
                    <button class="quick-action-btn" data-amount="1000">1000 TL</button>
                    <button class="quick-action-btn" data-amount="2000">2000 TL</button>
                    <button class="quick-action-btn" data-amount="5000">5000 TL</button>
                </div>
                
                <!-- Harcama Ekleme Bölümü -->
                <div class="expense-section">
                    <div class="section-title">
                        <h2><i class="fas fa-shopping-cart"></i> Harcamalar</h2>
                    </div>
                    
                    <div class="add-expense-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expenseName"><i class="fas fa-tag"></i> Harcama Adı</label>
                                <input type="text" id="expenseName" class="form-control" placeholder="Harcama adını girin" value="Test Harcama">
                            </div>
                            <div class="form-group">
                                <label for="expenseAmount"><i class="fas fa-money-bill"></i> Harcama Tutarı (TL)</label>
                                <input type="number" id="expenseAmount" class="form-control" placeholder="Tutar girin" value="1000">
                            </div>
                            <div class="form-group">
                                <label for="installmentCount"><i class="fas fa-calendar-alt"></i> Taksit Sayısı</label>
                                <input type="number" id="installmentCount" class="form-control" placeholder="Taksit sayısı" min="1" value="3">
                            </div>
                        </div>
                        <button class="btn btn-primary" id="addExpenseBtn">
                            <i class="fas fa-plus-circle"></i> Harcama Ekle
                        </button>
                        <div class="debug-info" id="debugInfo">
                            Durum: Taksitify yüklendi. Kart ekleyerek başlayın.
                        </div>
                    </div>
                    
                    <div class="expense-cards" id="expenseCards">
                        <div class="empty-state">
                            <i class="fas fa-receipt"></i>
                            <h3>Henüz harcama eklenmemiş</h3>
                            <p>Yukarıdaki formu kullanarak ilk harcamanızı ekleyin</p>
                        </div>
                    </div>
                </div>
                
                <!-- Aylık Ödeme Tablosu -->
                <div class="months-section">
                    <div class="section-title">
                        <h2><i class="fas fa-calendar-check"></i> Aylık Ödemeler</h2>
                        <div class="month-navigation">
                            <button class="btn btn-primary" id="prevMonthsBtn">
                                <i class="fas fa-chevron-left"></i> Önceki
                            </button>
                            <span id="monthRange">Aylar 1-6</span>
                            <button class="btn btn-primary" id="nextMonthsBtn">
                                Sonraki <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="months-container" id="monthsContainer">
                        <div class="empty-state">
                            <i class="fas fa-calendar-times"></i>
                            <h3>Henüz harcama eklenmemiş</h3>
                            <p>Harcama ekleyin ve aylara dağıtılsın</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Getiri Hesaplama Bölümü -->
            <div id="getiri-section" class="tool-section">
                <div class="header">
                    <h1><i class="fas fa-chart-line"></i> Getiri Hesaplama</h1>
                </div>
                
                <div class="finance-calculator active">
                    <div class="calculator-title">
                        <i class="fas fa-chart-line"></i> Yatırım Getirisi Hesaplayıcı
                    </div>
                    
                    <div class="calculator-grid">
                        <div class="calculator-inputs">
                            <div class="form-group">
                                <label for="initialPrice"><i class="fas fa-coins"></i> İlk Fiyat (TL)</label>
                                <input type="number" id="initialPrice" class="form-control" value="1000" min="0" step="0.01">
                            </div>
                            
                            <div class="form-group">
                                <label for="finalPrice"><i class="fas fa-money-bill-wave"></i> Son Fiyat (TL)</label>
                                <input type="number" id="finalPrice" class="form-control" value="1500" min="0" step="0.01">
                            </div>
                            
                            <div class="form-group">
                                <label for="periodValue"><i class="fas fa-clock"></i> Zaman Periyodu</label>
                                <div class="period-selector">
                                    <input type="number" id="periodValue" class="form-control period-input" value="1" min="1">
                                    <select id="periodType" class="period-select">
                                        <option value="daily">Günlük</option>
                                        <option value="monthly" selected>Aylık</option>
                                        <option value="yearly">Yıllık</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="inflationRate"><i class="fas fa-chart-bar"></i> Enflasyon Oranı (%)</label>
                                <input type="number" id="inflationRate" class="form-control" value="3.79" step="0.01">
                                <div class="enag-info">
                                    <i class="fas fa-info-circle"></i> ENAG Enflasyonu: %3.79 (Eylül 2025)
                                </div>
                                <div class="inflation-info" id="periodInflationInfo">
                                    <i class="fas fa-info-circle"></i> Aylık Enflasyon: %3.79
                                </div>
                            </div>
                            
                            <!-- YENİ: MANUEL STOPAJ GİRİŞİ -->
                            <div class="stopaj-section">
                                <div class="stopaj-toggle">
                                    <input type="checkbox" id="stopajToggle">
                                    <label for="stopajToggle" style="font-weight: bold; color: #856404;">
                                        <i class="fas fa-percentage"></i> Stopaj Hesaplaması Ekle
                                    </label>
                                </div>
                                
                                <div class="stopaj-content" id="stopajContent">
                                    <div class="form-group">
                                        <label for="stopajOrani"><i class="fas fa-receipt"></i> Stopaj Oranı (%)</label>
                                        <input type="number" id="stopajOrani" class="form-control" value="10" step="0.01" min="0" max="100">
                                        <div class="stopaj-info">
                                            <i class="fas fa-lightbulb"></i> Stopaj oranını manuel olarak girin (Türkiye'de mevduat faizi stopaj oranı: %10)
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="btn btn-success" id="calculateReturnBtn" style="width: 100%;">
                                <i class="fas fa-calculator"></i> Getiriyi Hesapla
                            </button>
                        </div>
                        
                        <div class="calculator-results">
                            <h4><i class="fas fa-list-alt"></i> Hesaplama Sonuçları</h4>
                            
                            <div class="result-item">
                                <span class="result-label">Nominal Getiri:</span>
                                <span class="result-value" id="nominalReturn">500 TL</span>
                            </div>
                            
                            <div class="result-item">
                                <span class="result-label">Nominal Getiri Oranı:</span>
                                <span class="result-value" id="nominalReturnRate">50.00%</span>
                            </div>
                            
                            <div class="result-item">
                                <span class="result-label">Yıllık Getiri Oranı:</span>
                                <span class="result-value" id="annualReturnRate">50.00%</span>
                            </div>
                            
                            <!-- YENİ: STOPAJ DETAYLARI -->
                            <div class="tax-breakdown" id="taxBreakdown" style="display: none;">
                                <h5 style="margin-bottom: 15px; color: #e74c3c;">
                                    <i class="fas fa-receipt"></i> Vergi Kesintileri
                                </h5>
                                
                                <div class="tax-item">
                                    <span class="tax-label">Stopaj Oranı:</span>
                                    <span class="tax-value" id="stopajOraniDisplay">%10</span>
                                </div>
                                
                                <div class="tax-item">
                                    <span class="tax-label">Stopaj Tutarı:</span>
                                    <span class="tax-value" id="stopajTutari">50 TL</span>
                                </div>
                                
                                <div class="tax-item">
                                    <span class="tax-label">Net Getiri (Vergi Sonrası):</span>
                                    <span class="tax-value" id="netGetiri">450 TL</span>
                                </div>
                            </div>
                            
                            <!-- DÜZELTİLMİŞ: REEL GETİRİ ARTIK NET KAZANCIN ENFLASYONDAN ARINDIRILMIŞ HALİ -->
                            <div class="result-highlight">
                                <div class="result-item">
                                    <span class="result-label">Reel Getiri (Net Kazancın Enflasyondan Arındırılmış Hali):</span>
                                    <span class="result-value" id="realReturn">442.10 TL</span>
                                </div>
                            </div>
                            
                            <div class="result-item">
                                <span class="result-label">Reel Getiri Oranı:</span>
                                <span class="result-value" id="realReturnRate">44.21%</span>
                            </div>
                            
                            <div class="result-item">
                                <span class="result-label">Satın Alma Gücü Artışı:</span>
                                <span class="result-value" id="purchasingPower">44.21%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Getiri Grafikleri -->
                    <div class="return-charts">
                        <div class="chart-container">
                            <h3 class="chart-title">Getiri Karşılaştırması</h3>
                            <div class="chart-wrapper">
                                <canvas id="returnChart"></canvas>
                            </div>
                            <div class="stacked-bar-legend" id="stackedLegend"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aylık Bütçe Hesaplayıcı Bölümü -->
            <div id="monthly-budget-section" class="tool-section">
                <div class="header">
                    <h1><i class="fas fa-wallet"></i> Aylık Bütçe Hesaplayıcı</h1>
                </div>
                <div class="finance-calculator active">
                    <div class="calculator-title">
                        <i class="fas fa-calculator"></i> Aylık Bütçe Planlayıcı
                    </div>
                    <div class="empty-state">
                        <i class="fas fa-tools"></i>
                        <h3>Yakında Hizmetinizde</h3>
                        <p>Bu özellik şu anda geliştirme aşamasındadır</p>
                    </div>
                </div>
            </div>

            <!-- Enflasyon Verileri Bölümü -->
            <div id="inflation-section" class="tool-section">
                <div class="header">
                    <h1><i class="fas fa-chart-bar"></i> Enflasyon Verileri</h1>
                </div>
                
                <div class="finance-calculator active">
                    <div class="calculator-title">
                        <i class="fas fa-chart-line"></i> 2025 Yılı Enflasyon Verileri
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="inflationChart"></canvas>
                        <div class="chart-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #3498db;"></div>
                                <span>TÜİK</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #2ecc71;"></div>
                                <span>İTO</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #e74c3c;"></div>
                                <span>ENAG</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-comparison">
                        <h3>2025 Yılı Aylık Enflasyon Verileri</h3>
                        <table class="inflation-table">
                            <thead>
                                <tr>
                                    <th>Ay</th>
                                    <th>TÜİK (%)</th>
                                    <th>İTO (%)</th>
                                    <th>ENAG (%)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Eylül 2025</td>
                                    <td class="tuk">3,23</td>
                                    <td class="ito">3,19</td>
                                    <td class="enag">3,79</td>
                                </tr>
                                <tr>
                                    <td>Ağustos 2025</td>
                                    <td class="tuk">2,04</td>
                                    <td class="ito">1,84</td>
                                    <td class="enag">3,23</td>
                                </tr>
                                <tr>
                                    <td>Temmuz 2025</td>
                                    <td class="tuk">2,06</td>
                                    <td class="ito">2,62</td>
                                    <td class="enag">3,75</td>
                                </tr>
                                <tr>
                                    <td>Haziran 2025</td>
                                    <td class="tuk">1,37</td>
                                    <td class="ito">1,77</td>
                                    <td class="enag">3,05</td>
                                </tr>
                                <tr>
                                    <td>Mayıs 2025</td>
                                    <td class="tuk">1,53</td>
                                    <td class="ito">2,83</td>
                                    <td class="enag">3,66</td>
                                </tr>
                                <tr>
                                    <td>Nisan 2025</td>
                                    <td class="tuk">3,00</td>
                                    <td class="ito">3,21</td>
                                    <td class="enag">4,46</td>
                                </tr>
                                <tr>
                                    <td>Mart 2025</td>
                                    <td class="tuk">2,46</td>
                                    <td class="ito">3,79</td>
                                    <td class="enag">3,91</td>
                                </tr>
                                <tr>
                                    <td>Şubat 2025</td>
                                    <td class="tuk">2,27</td>
                                    <td class="ito">3,19</td>
                                    <td class="enag">3,37</td>
                                </tr>
                                <tr>
                                    <td>Ocak 2025</td>
                                    <td class="tuk">5,03</td>
                                    <td class="ito">5,16</td>
                                    <td class="enag">8,20</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="calculator-result">
                        <h4><i class="fas fa-info-circle"></i> Enflasyon Verileri Hakkında</h4>
                        <p>Bu grafik ve tablo, TÜİK (Türkiye İstatistik Kurumu), İTO (İstanbul Ticaret Odası) ve ENAG (Enflasyon Araştırma Grubu) tarafından açıklanan 2025 yılı aylık enflasyon verilerini karşılaştırmalı olarak göstermektedir.</p>
                    </div>
                </div>
            </div>

            <!-- Yararlı Siteler Bölümü -->
            <div id="useful-sites-section" class="tool-section">
                <div class="header">
                    <h1><i class="fas fa-link"></i> Yararlı Finans Siteleri</h1>
                </div>
                
                <div class="useful-sites">
                    <div class="site-list">
                        <!-- 1. CNBC-e -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #FF0000, #8B0000);">
                                <i class="fab fa-youtube"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://www.youtube.com/@cnbce" target="_blank">CNBC-e - YouTube Kanalı</a>
                                <div class="site-description">Ekonomi ve iş dünyasından güncel haberler ve analizler</div>
                            </div>
                        </div>
                        
                        <!-- 2. Donanımhaber Forum -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #1e88e5, #0d47a1);">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://forum.donanimhaber.com/yatirim-fonlari-bes-fonlari-ana-konu--147353253" target="_blank">Donanımhaber Yatırım Fonları Forumu</a>
                                <div class="site-description">Yatırım fonları ve BES fonları hakkında topluluk tartışmaları</div>
                            </div>
                        </div>
                        
                        <!-- 3. Cihat E. Çiçek -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #FF0000, #CC0000);">
                                <i class="fab fa-youtube"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://www.youtube.com/@cihatecicek" target="_blank">Cihat E. Çiçek - YouTube Kanalı</a>
                                <div class="site-description">Finans, ekonomi ve yatırım konularında eğitici içerikler</div>
                            </div>
                        </div>
                        
                        <!-- 4. Fonparam.com -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #4caf50, #2e7d32);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://www.fonparam.com" target="_blank">Fonparam.com</a>
                                <div class="site-description">Yatırım fonları performans takibi ve karşılaştırma platformu</div>
                            </div>
                        </div>
                        
                        <!-- 5. Bankacılık Ürün ve Hizmet Ücretleri -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #9c27b0, #6a1b9a);">
                                <i class="fas fa-landmark"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://www.bankacilikurunvehizmetucretleri.org.tr" target="_blank">Bankacılık Ürün ve Hizmet Ücretleri</a>
                                <div class="site-description">Bankacılık ürünleri ve hizmet ücretleri karşılaştırma platformu</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Kart Ekleme Modal -->
    <div class="modal" id="addCardModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Yeni Kart Ekle</h3>
                <button class="close-modal" id="closeModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="modalCardName"><i class="fas fa-credit-card"></i> Kart Adı</label>
                    <input type="text" id="modalCardName" class="form-control" placeholder="Kart adını girin">
                </div>
                <div class="form-group">
                    <label for="modalAsLimit"><i class="fas fa-cog"></i> As Limit (TL)</label>
                    <input type="number" id="modalAsLimit" class="form-control" placeholder="As limit girin" value="25000">
                </div>
                <div class="form-group">
                    <label for="modalCardLimit"><i class="fas fa-money-bill-wave"></i> Kullanılabilir Limit (TL)</label>
                    <input type="number" id="modalCardLimit" class="form-control" placeholder="Kart limitini girin">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelAddCardBtn">
                    <i class="fas fa-times"></i> İptal
                </button>
                <button class="btn btn-success" id="confirmAddCardBtn">
                    <i class="fas fa-check"></i> Kart Ekle
                </button>
            </div>
        </div>
    </div>

    <script>
        // DEBUG: Hata ayıklama için konsol çıktısı
        function debugLog(message) {
            console.log(`[Taksitify] ${message}`);
            const debugInfo = document.getElementById('debugInfo');
            if (debugInfo) {
                debugInfo.textContent = `Durum: ${message}`;
            }
        }

        // Rastgele renk üretme fonksiyonu
        function getRandomColor(opacity = 1) {
            const r = Math.floor(Math.random() * 256);
            const g = Math.floor(Math.random() * 256);
            const b = Math.floor(Math.random() * 256);
            return `rgba(${r}, ${g}, ${b}, ${opacity})`;
        }

        // Uygulama durumu
        const state = {
            cards: [],
            currentCard: null,
            expenses: [],
            months: [],
            payments: [],
            currentTool: 'taksit',
            currentMonthIndex: 0,
            monthsPerView: 6,
            asLimit: 25000
        };

        // Enflasyon verileri
        const inflationData = {
            months: ['Ocak 2025', 'Şubat 2025', 'Mart 2025', 'Nisan 2025', 'Mayıs 2025', 'Haziran 2025', 'Temmuz 2025', 'Ağustos 2025', 'Eylül 2025'],
            tuk: [5.03, 2.27, 2.46, 3.00, 1.53, 1.37, 2.06, 2.04, 3.23],
            ito: [5.16, 3.19, 3.79, 3.21, 2.83, 1.77, 2.62, 1.84, 3.19],
            enag: [8.20, 3.37, 3.91, 4.46, 3.66, 3.05, 3.75, 3.23, 3.79]
        };

        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('Taksitify başlatılıyor...');
            initializeApp();
            setupEventListeners();
            renderInflationChart();
            setupInvestmentCalculator();
            setupStopajToggle();
        });

        // Stopaj toggle ayarları
        function setupStopajToggle() {
            const stopajToggle = document.getElementById('stopajToggle');
            const stopajContent = document.getElementById('stopajContent');
            
            stopajToggle.addEventListener('change', function() {
                if (this.checked) {
                    stopajContent.classList.add('active');
                    debugLog('Stopaj hesaplaması aktifleştirildi');
                } else {
                    stopajContent.classList.remove('active');
                    debugLog('Stopaj hesaplaması devre dışı bırakıldı');
                }
                calculateInvestmentReturn();
            });
        }

        // Uygulamayı başlat
        function initializeApp() {
            debugLog('Özellikler yükleniyor...');
            
            // Tool seçimini ayarla
            setupToolSelection();
            
            debugLog('Taksitify hazır!');
        }

        // Event listener'ları kur
        function setupEventListeners() {
            debugLog('Event listenerlar kuruluyor...');
            
            // Kart ekle butonu - Modal aç
            document.getElementById('addCardBtn').addEventListener('click', function() {
                debugLog('Kart ekle butonuna tıklandı, modal açılıyor');
                openAddCardModal();
            });
            
            // Modal kapatma butonları
            document.getElementById('closeModalBtn').addEventListener('click', closeAddCardModal);
            document.getElementById('cancelAddCardBtn').addEventListener('click', closeAddCardModal);
            
            // Kart ekleme onay butonu
            document.getElementById('confirmAddCardBtn').addEventListener('click', function() {
                debugLog('Kart ekleme onay butonuna tıklandı');
                confirmAddCard();
            });
            
            // Modal dışına tıklayarak kapatma
            document.getElementById('addCardModal').addEventListener('click', function(e) {
                if (e.target === document.getElementById('addCardModal')) {
                    closeAddCardModal();
                }
            });
            
            // Harcama ekle butonu
            document.getElementById('addExpenseBtn').addEventListener('click', function(e) {
                debugLog('Harcama ekle butonuna tıklandı');
                addExpense();
            });
            
            // Ay navigasyon butonları
            document.getElementById('prevMonthsBtn').addEventListener('click', function() {
                if (state.currentMonthIndex > 0) {
                    state.currentMonthIndex--;
                    renderMonthColumns();
                }
            });
            
            document.getElementById('nextMonthsBtn').addEventListener('click', function() {
                if (state.currentMonthIndex + state.monthsPerView < state.months.length) {
                    state.currentMonthIndex++;
                    renderMonthColumns();
                }
            });
            
            // As Limit input değişikliği
            document.getElementById('asLimitInput').addEventListener('change', function() {
                const newAsLimit = parseFloat(document.getElementById('asLimitInput').value);
                if (!isNaN(newAsLimit) && newAsLimit > 0) {
                    state.asLimit = newAsLimit;
                    updateUI();
                    debugLog(`As Limit güncellendi: ${state.asLimit} TL`);
                } else {
                    alert('Lütfen geçerli bir As Limit değeri girin.');
                    document.getElementById('asLimitInput').value = state.asLimit;
                }
            });
            
            // Hızlı işlem butonlarını ayarla
            setupQuickActions();
            
            debugLog('Event listenerlar kuruldu');
        }

        // Getiri Hesaplama fonksiyonlarını kur
        function setupInvestmentCalculator() {
            // Getiri hesaplama butonu
            const calculateReturnBtn = document.getElementById('calculateReturnBtn');
            calculateReturnBtn.addEventListener('click', calculateInvestmentReturn);
            
            // Zaman periyodu değişikliği
            document.getElementById('periodType').addEventListener('change', updateInflationRate);
            document.getElementById('periodValue').addEventListener('input', updateInflationRate);
            
            // İlk hesaplamayı yap
            updateInflationRate();
            calculateInvestmentReturn();
            
            debugLog('Getiri hesaplama fonksiyonları kuruldu');
        }

        // Enflasyon oranını güncelle
        function updateInflationRate() {
            const periodType = document.getElementById('periodType').value;
            const periodValue = parseFloat(document.getElementById('periodValue').value);
            const monthlyInflation = 3.79; // ENAG Eylül 2025 aylık enflasyonu
            
            let periodInflation, inflationInfo;
            
            switch(periodType) {
                case 'daily':
                    // Günlük enflasyon = Aylık enflasyon / 30
                    periodInflation = monthlyInflation / 30;
                    inflationInfo = `Günlük Enflasyon: ${periodInflation.toFixed(2)}%`;
                    break;
                case 'monthly':
                    // Aylık enflasyon = ENAG aylık enflasyonu
                    periodInflation = monthlyInflation;
                    inflationInfo = `Aylık Enflasyon: ${periodInflation.toFixed(2)}%`;
                    break;
                case 'yearly':
                    // Yıllık enflasyon = Aylık enflasyon * 12
                    periodInflation = monthlyInflation * 12;
                    inflationInfo = `Yıllık Enflasyon: ${periodInflation.toFixed(2)}%`;
                    break;
            }
            
            // Dönem enflasyonunu hesapla (bileşik)
            const periodTotalInflation = periodInflation * periodValue;
            
            document.getElementById('inflationRate').value = periodTotalInflation.toFixed(2);
            document.getElementById('periodInflationInfo').textContent = inflationInfo;
            
            debugLog(`Enflasyon oranı güncellendi: ${periodType} - ${periodTotalInflation.toFixed(2)}%`);
        }

        // Getiri hesapla
        function calculateInvestmentReturn() {
            debugLog('Getiri hesaplama başlatıldı');
            
            const initialPrice = parseFloat(document.getElementById('initialPrice').value);
            const finalPrice = parseFloat(document.getElementById('finalPrice').value);
            const periodValue = parseFloat(document.getElementById('periodValue').value);
            const periodType = document.getElementById('periodType').value;
            const inflationRate = parseFloat(document.getElementById('inflationRate').value) / 100;
            const stopajToggle = document.getElementById('stopajToggle').checked;
            const stopajOrani = parseFloat(document.getElementById('stopajOrani').value) / 100;
            
            if (isNaN(initialPrice) || isNaN(finalPrice) || isNaN(periodValue) || isNaN(inflationRate)) {
                alert('Lütfen tüm alanları doğru şekilde doldurun.');
                return;
            }
            
            if (initialPrice <= 0) {
                alert('İlk fiyat 0\'dan büyük olmalıdır.');
                return;
            }
            
            // Nominal getiri hesaplama
            const nominalReturn = finalPrice - initialPrice;
            const nominalReturnRate = (nominalReturn / initialPrice) * 100;
            
            // Yıllık getiri oranı hesaplama
            let annualReturnRate;
            switch(periodType) {
                case 'daily':
                    // Günlük getiriyi yıllığa çevir
                    annualReturnRate = nominalReturnRate * 365 / periodValue;
                    break;
                case 'monthly':
                    // Aylık getiriyi yıllığa çevir
                    annualReturnRate = nominalReturnRate * 12 / periodValue;
                    break;
                case 'yearly':
                    // Yıllık getiri
                    annualReturnRate = nominalReturnRate;
                    break;
            }
            
            // Stopaj hesaplaması
            let stopajTutari = 0;
            let netGetiri = nominalReturn;
            
            if (stopajToggle) {
                stopajTutari = nominalReturn * stopajOrani;
                netGetiri = nominalReturn - stopajTutari;
                
                // Vergi detaylarını göster
                document.getElementById('taxBreakdown').style.display = 'block';
                document.getElementById('stopajOraniDisplay').textContent = '%' + (stopajOrani * 100).toFixed(2);
                document.getElementById('stopajTutari').textContent = formatCurrency(stopajTutari);
                document.getElementById('netGetiri').textContent = formatCurrency(netGetiri);
                
                debugLog(`Stopaj hesaplandı: Stopaj Tutarı: ${stopajTutari.toFixed(2)} TL, Net Getiri: ${netGetiri.toFixed(2)} TL`);
            } else {
                document.getElementById('taxBreakdown').style.display = 'none';
            }
            
            // Reel getiri hesaplama (enflasyondan arındırılmış)
            // Artık net getiriyi enflasyondan arındırıyoruz
            const realReturnRate = (netGetiri / initialPrice) * 100 - (inflationRate * 100);
            const realReturn = initialPrice * (realReturnRate / 100);
            
            // Sonuçları göster
            document.getElementById('nominalReturn').textContent = formatCurrency(nominalReturn);
            document.getElementById('nominalReturnRate').textContent = nominalReturnRate.toFixed(2) + '%';
            document.getElementById('annualReturnRate').textContent = annualReturnRate.toFixed(2) + '%';
            document.getElementById('realReturn').textContent = formatCurrency(realReturn);
            document.getElementById('realReturnRate').textContent = realReturnRate.toFixed(2) + '%';
            document.getElementById('purchasingPower').textContent = realReturnRate.toFixed(2) + '%';
            
            // Grafikleri oluştur
            createReturnChart(initialPrice, finalPrice, realReturn, stopajToggle, stopajTutari, netGetiri);
            
            debugLog(`Getiri hesaplandı: Nominal Getiri: ${nominalReturn.toFixed(2)} TL, Reel Getiri: ${realReturn.toFixed(2)} TL`);
        }

        // Getiri grafiğini oluştur - DÜZELTİLMİŞ STACKED BAR CHART
        function createReturnChart(initialPrice, finalPrice, realReturn, stopajToggle, stopajTutari, netGetiri) {
            debugLog('Getiri grafiği oluşturuluyor...');
            
            const ctx = document.getElementById('returnChart').getContext('2d');
            const legendContainer = document.getElementById('stackedLegend');
            
            // Önceki grafik varsa destroy et
            if (window.returnChartInstance) {
                window.returnChartInstance.destroy();
            }

            // Legend'ı temizle
            legendContainer.innerHTML = '';

            // Rastgele renkler oluştur
            const initialColor = '#3498db';
            const finalColor = '#2ecc71';
            const positiveReturnColor = '#f39c12';
            const negativeReturnColor = '#e74c3c';
            const stopajColor = '#9b59b6';

            const isPositiveReturn = realReturn >= 0;
            const totalWithReturn = initialPrice + realReturn;

            // Veri setlerini hazırla - STACKED YAPISI
            let datasets = [];
            let labels = ['İlk Fiyat', 'Son Fiyat', 'As Kazanç'];

            if (stopajToggle) {
                // STOPAJLI DURUM - 3. sütun: İlk Fiyat + Net Getiri (STACKED)
                datasets = [
                    // İlk Fiyat sütunu
                    {
                        label: 'İlk Fiyat',
                        data: [initialPrice, 0, initialPrice],
                        backgroundColor: initialColor,
                        borderColor: initialColor,
                        borderWidth: 2
                    },
                    // Son Fiyat sütunu
                    {
                        label: 'Son Fiyat',
                        data: [0, finalPrice, 0],
                        backgroundColor: finalColor,
                        borderColor: finalColor,
                        borderWidth: 2
                    },
                    // 3. sütun: Net Getiri (STACKED - İlk Fiyat'ın üstüne ekleniyor)
                    {
                        label: 'Net Getiri (Stopaj Sonrası)',
                        data: [0, 0, netGetiri],
                        backgroundColor: positiveReturnColor,
                        borderColor: positiveReturnColor,
                        borderWidth: 2
                    }
                ];

                // Legend için stopajlı durum bilgisi
                legendContainer.innerHTML = `
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${initialColor}; border-radius: 3px;"></div>
                        <span>İlk Fiyat: ${formatCurrency(initialPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${finalColor}; border-radius: 3px;"></div>
                        <span>Son Fiyat: ${formatCurrency(finalPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${positiveReturnColor}; border-radius: 3px;"></div>
                        <span>Net Getiri: ${formatCurrency(netGetiri)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${stopajColor}; border-radius: 3px;"></div>
                        <span>Stopaj Kesintisi: ${formatCurrency(stopajTutari)}</span>
                    </div>
                    <div class="stacked-legend-item" style="background-color: #e8f5e8;">
                        <strong>As Kazanç (İlk Fiyat + Net Getiri): ${formatCurrency(initialPrice + netGetiri)}</strong>
                    </div>
                `;
            } else if (isPositiveReturn) {
                // POZİTİF REEL GETİRİ - 3. sütun: İlk Fiyat + Reel Getiri (STACKED)
                datasets = [
                    // İlk Fiyat sütunu
                    {
                        label: 'İlk Fiyat',
                        data: [initialPrice, 0, initialPrice],
                        backgroundColor: initialColor,
                        borderColor: initialColor,
                        borderWidth: 2
                    },
                    // Son Fiyat sütunu
                    {
                        label: 'Son Fiyat',
                        data: [0, finalPrice, 0],
                        backgroundColor: finalColor,
                        borderColor: finalColor,
                        borderWidth: 2
                    },
                    // 3. sütun: Reel Getiri (STACKED - İlk Fiyat'ın üstüne ekleniyor)
                    {
                        label: 'Reel Getiri',
                        data: [0, 0, realReturn],
                        backgroundColor: positiveReturnColor,
                        borderColor: positiveReturnColor,
                        borderWidth: 2
                    }
                ];

                // Legend için pozitif getiri bilgisi
                legendContainer.innerHTML = `
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${initialColor}; border-radius: 3px;"></div>
                        <span>İlk Fiyat: ${formatCurrency(initialPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${finalColor}; border-radius: 3px;"></div>
                        <span>Son Fiyat: ${formatCurrency(finalPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${positiveReturnColor}; border-radius: 3px;"></div>
                        <span>Reel Getiri: ${formatCurrency(realReturn)}</span>
                    </div>
                    <div class="stacked-legend-item" style="background-color: #e8f5e8;">
                        <strong>As Kazanç (İlk Fiyat + Reel Getiri): ${formatCurrency(totalWithReturn)}</strong>
                    </div>
                `;
            } else {
                // NEGATİF REEL GETİRİ - 3. sütun: İlk Fiyat - Kayıp (STACKED)
                const lossAmount = Math.abs(realReturn);
                const netValue = initialPrice - lossAmount;
                
                datasets = [
                    // İlk Fiyat sütunu
                    {
                        label: 'İlk Fiyat',
                        data: [initialPrice, 0, netValue], // Net değer gösteriliyor
                        backgroundColor: initialColor,
                        borderColor: initialColor,
                        borderWidth: 2
                    },
                    // Son Fiyat sütunu
                    {
                        label: 'Son Fiyat',
                        data: [0, finalPrice, 0],
                        backgroundColor: finalColor,
                        borderColor: finalColor,
                        borderWidth: 2
                    },
                    // 3. sütun: Reel Getiri Kaybı (STACKED - İlk Fiyat'ın üstünde kayıp gösterimi)
                    {
                        label: 'Reel Getiri Kaybı',
                        data: [0, 0, lossAmount],
                        backgroundColor: negativeReturnColor,
                        borderColor: negativeReturnColor,
                        borderWidth: 2
                    }
                ];

                // Legend için negatif getiri bilgisi
                legendContainer.innerHTML = `
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${initialColor}; border-radius: 3px;"></div>
                        <span>İlk Fiyat: ${formatCurrency(initialPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${finalColor}; border-radius: 3px;"></div>
                        <span>Son Fiyat: ${formatCurrency(finalPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${negativeReturnColor}; border-radius: 3px;"></div>
                        <span>Reel Getiri Kaybı: ${formatCurrency(lossAmount)}</span>
                    </div>
                    <div class="stacked-legend-item" style="background-color: #ffeaea;">
                        <strong>As Kazanç (Net): ${formatCurrency(netValue)}</strong>
                    </div>
                `;
            }

            window.returnChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            stacked: true, // Y ekseninde stacked aktif
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            },
                            title: {
                                display: true,
                                text: 'Tutar (TL)'
                            }
                        },
                        x: {
                            stacked: true, // X ekseninde de stacked aktif
                            title: {
                                display: true,
                                text: 'Değerler'
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${formatCurrency(context.raw)}`;
                                }
                            }
                        },
                        legend: {
                            display: false // Legend'ı manuel olarak gösteriyoruz
                        }
                    }
                }
            });
            
            debugLog('Getiri grafiği oluşturuldu');
        }

        // Para formatı
        function formatCurrency(amount) {
            return new Intl.NumberFormat('tr-TR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount) + ' TL';
        }

        // Tool seçimini ayarla
        function setupToolSelection() {
            const toolItems = document.querySelectorAll('.tool-item');
            toolItems.forEach(item => {
                item.addEventListener('click', function() {
                    const tool = this.dataset.tool;
                    switchTool(tool);
                    
                    // Aktif tool'u vurgula
                    toolItems.forEach(toolItem => {
                        toolItem.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
        }

        // Tool değiştir
        function switchTool(tool) {
            debugLog(`Tool değiştiriliyor: ${tool}`);
            
            // Tüm tool section'ları gizle
            document.querySelectorAll('.tool-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Seçili tool'u göster
            const targetSection = document.getElementById(`${tool}-section`);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            state.currentTool = tool;
            
            // Getiri tool'una geçildiğinde grafiği yeniden render et
            if (tool === 'getiri') {
                setTimeout(() => {
                    calculateInvestmentReturn();
                }, 100);
            }
            
            // Enflasyon tool'una geçildiğinde grafiği yeniden render et
            if (tool === 'inflation') {
                setTimeout(() => {
                    renderInflationChart();
                }, 100);
            }
            
            debugLog(`Aktif tool: ${tool}`);
        }

        // Hızlı işlem butonlarını ayarla
        function setupQuickActions() {
            const quickActionBtns = document.querySelectorAll('.quick-action-btn');
            quickActionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const amount = parseFloat(this.dataset.amount);
                    document.getElementById('expenseAmount').value = amount;
                    debugLog(`Hızlı işlem: ${amount} TL seçildi`);
                });
            });
        }

        // Enflasyon grafiğini render et
        function renderInflationChart() {
            debugLog('Enflasyon grafiği oluşturuluyor...');
            
            const ctx = document.getElementById('inflationChart').getContext('2d');
            
            // Eğer önceki chart varsa destroy et
            if (window.inflationChartInstance) {
                window.inflationChartInstance.destroy();
            }
            
            window.inflationChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: inflationData.months,
                    datasets: [
                        {
                            label: 'TÜİK',
                            data: inflationData.tuk,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'İTO',
                            data: inflationData.ito,
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'ENAG',
                            data: inflationData.enag,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '2025 Yılı Aylık Enflasyon Karşılaştırması',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: %${context.parsed.y.toFixed(2)}`;
                                }
                            }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Enflasyon Oranı (%)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '%' + value;
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Aylar'
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'nearest'
                    }
                }
            });
            
            debugLog('Enflasyon grafiği oluşturuldu');
        }

        // Kart ekleme modal'ını aç
        function openAddCardModal() {
            debugLog('Kart ekleme modalı açılıyor');
            document.getElementById('addCardModal').classList.add('active');
            document.getElementById('modalCardName').focus();
        }

        // Kart ekleme modal'ını kapat
        function closeAddCardModal() {
            debugLog('Kart ekleme modalı kapatılıyor');
            document.getElementById('addCardModal').classList.remove('active');
            // Formu temizle
            document.getElementById('modalCardName').value = '';
            document.getElementById('modalAsLimit').value = '25000';
            document.getElementById('modalCardLimit').value = '';
        }

        // Kart ekleme onayla
        function confirmAddCard() {
            const cardName = document.getElementById('modalCardName').value.trim();
            const asLimit = parseFloat(document.getElementById('modalAsLimit').value);
            const cardLimit = parseFloat(document.getElementById('modalCardLimit').value);
            
            if (!cardName) {
                alert('Lütfen bir kart adı girin.');
                return;
            }
            
            if (isNaN(asLimit) || asLimit <= 0) {
                alert('Lütfen geçerli bir As Limit değeri girin.');
                return;
            }
            
            if (isNaN(cardLimit) || cardLimit <= 0) {
                alert('Lütfen geçerli bir kart limiti girin.');
                return;
            }
            
            // Yeni kart oluştur
            const newCard = {
                id: Date.now().toString(),
                name: cardName,
                asLimit: asLimit,
                limit: cardLimit,
                availableLimit: cardLimit,
                totalDebt: 0,
                minPayment: 0
            };
            
            // State'e ekle
            state.cards.push(newCard);
            
            // Aktif kartı ayarla
            state.currentCard = newCard;
            
            // UI'ı güncelle
            updateUI();
            
            // Modal'ı kapat
            closeAddCardModal();
            
            debugLog(`Yeni kart eklendi: ${cardName}`);
        }

        // Harcama ekle
        function addExpense() {
            if (!state.currentCard) {
                alert('Lütfen önce bir kart seçin.');
                return;
            }
            
            const expenseName = document.getElementById('expenseName').value.trim();
            const expenseAmount = parseFloat(document.getElementById('expenseAmount').value);
            const installmentCount = parseInt(document.getElementById('installmentCount').value);
            
            if (!expenseName) {
                alert('Lütfen bir harcama adı girin.');
                return;
            }
            
            if (isNaN(expenseAmount) || expenseAmount <= 0) {
                alert('Lütfen geçerli bir harcama tutarı girin.');
                return;
            }
            
            if (isNaN(installmentCount) || installmentCount <= 0) {
                alert('Lütfen geçerli bir taksit sayısı girin.');
                return;
            }
            
            // Yeni harcama oluştur
            const newExpense = {
                id: Date.now().toString(),
                name: expenseName,
                amount: expenseAmount,
                installments: installmentCount,
                monthlyPayment: expenseAmount / installmentCount,
                cardId: state.currentCard.id
            };
            
            // State'e ekle
            state.expenses.push(newExpense);
            
            // UI'ı güncelle
            updateUI();
            
            debugLog(`Yeni harcama eklendi: ${expenseName} - ${expenseAmount} TL - ${installmentCount} taksit`);
        }

        // UI'ı güncelle
        function updateUI() {
            // Kart listesini güncelle
            updateCardList();
            
            // Kart bilgilerini güncelle
            updateCardInfo();
            
            // Harcamaları güncelle
            updateExpenses();
            
            // Aylık ödemeleri güncelle
            updateMonthColumns();
        }

        // Kart listesini güncelle
        function updateCardList() {
            const cardList = document.getElementById('cardList');
            
            if (state.cards.length === 0) {
                cardList.innerHTML = '<div class="empty-state"><i class="fas fa-credit-card"></i><h3>Henüz kart eklenmemiş</h3><p>Yeni bir kart eklemek için "+" butonuna tıklayın</p></div>';
                return;
            }
            
            cardList.innerHTML = '';
            
            state.cards.forEach(card => {
                const cardItem = document.createElement('li');
                cardItem.className = `card-item ${state.currentCard && state.currentCard.id === card.id ? 'active' : ''}`;
                cardItem.innerHTML = `
                    <div class="card-name">${card.name}</div>
                    <div class="card-stats">
                        <span>Limit: ${formatCurrency(card.limit)}</span>
                        <span>Kalan: ${formatCurrency(card.availableLimit)}</span>
                    </div>
                    <button class="card-delete-btn" data-card-id="${card.id}">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                cardItem.addEventListener('click', () => {
                    state.currentCard = card;
                    updateUI();
                    debugLog(`Kart değiştirildi: ${card.name}`);
                });
                
                // Silme butonu event listener'ı
                const deleteBtn = cardItem.querySelector('.card-delete-btn');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteCard(card.id);
                });
                
                cardList.appendChild(cardItem);
            });
        }

        // Kart bilgilerini güncelle
        function updateCardInfo() {
            if (!state.currentCard) {
                document.getElementById('currentCardName').textContent = 'Kart Seçin';
                document.getElementById('availableLimit').textContent = '0 TL';
                document.getElementById('totalDebt').textContent = '0 TL';
                document.getElementById('minPayment').textContent = '0 TL';
                document.getElementById('limitFill').style.width = '0%';
                return;
            }
            
            document.getElementById('currentCardName').textContent = state.currentCard.name;
            document.getElementById('availableLimit').textContent = formatCurrency(state.currentCard.availableLimit);
            document.getElementById('totalDebt').textContent = formatCurrency(state.currentCard.totalDebt);
            document.getElementById('minPayment').textContent = formatCurrency(state.currentCard.minPayment);
            
            // Limit doluluk oranını güncelle
            const usedLimit = state.currentCard.limit - state.currentCard.availableLimit;
            const limitPercentage = (usedLimit / state.currentCard.limit) * 100;
            document.getElementById('limitFill').style.width = `${limitPercentage}%`;
        }

        // Harcamaları güncelle
        function updateExpenses() {
            const expenseCards = document.getElementById('expenseCards');
            const currentCardExpenses = state.expenses.filter(expense => expense.cardId === state.currentCard.id);
            
            if (currentCardExpenses.length === 0) {
                expenseCards.innerHTML = '<div class="empty-state"><i class="fas fa-receipt"></i><h3>Henüz harcama eklenmemiş</h3><p>Yukarıdaki formu kullanarak ilk harcamanızı ekleyin</p></div>';
                return;
            }
            
            expenseCards.innerHTML = '';
            
            currentCardExpenses.forEach(expense => {
                const expenseCard = document.createElement('div');
                expenseCard.className = 'expense-card';
                expenseCard.innerHTML = `
                    <div class="expense-card-header">
                        <div class="expense-name">${expense.name}</div>
                        <button class="delete-btn" data-expense-id="${expense.id}">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="expense-details">
                        <p><span class="label">Toplam:</span> <span class="value">${formatCurrency(expense.amount)}</span></p>
                        <p><span class="label">Taksit:</span> <span class="value">${expense.installments} ay</span></p>
                        <p><span class="label">Aylık:</span> <span class="value">${formatCurrency(expense.monthlyPayment)}</span></p>
                    </div>
                `;
                
                // Silme butonu event listener'ı
                const deleteBtn = expenseCard.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', () => {
                    deleteExpense(expense.id);
                });
                
                expenseCards.appendChild(expenseCard);
            });
        }

        // Aylık ödemeleri güncelle
        function updateMonthColumns() {
            // Bu fonksiyon aylık ödeme tablosunu günceller
            // Basit bir implementasyon:
            renderMonthColumns();
        }

        // Aylık sütunları render et
        function renderMonthColumns() {
            const monthsContainer = document.getElementById('monthsContainer');
            
            if (state.expenses.length === 0) {
                monthsContainer.innerHTML = '<div class="empty-state"><i class="fas fa-calendar-times"></i><h3>Henüz harcama eklenmemiş</h3><p>Harcama ekleyin ve aylara dağıtılsın</p></div>';
                return;
            }
            
            // Basit bir implementasyon - gerçek uygulamada daha karmaşık hesaplamalar yapılır
            monthsContainer.innerHTML = '';
            
            for (let i = 0; i < 6; i++) {
                const monthColumn = document.createElement('div');
                monthColumn.className = 'month-column';
                monthColumn.innerHTML = `
                    <div class="month-header">Ay ${i + 1}</div>
                    <div class="month-total">Toplam: ${formatCurrency(500)}</div>
                `;
                
                monthsContainer.appendChild(monthColumn);
            }
            
            document.getElementById('monthRange').textContent = `Aylar 1-6`;
        }

        // Kart sil
        function deleteCard(cardId) {
            if (confirm('Bu kartı silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.')) {
                state.cards = state.cards.filter(card => card.id !== cardId);
                
                // Eğer silinen kart aktif kart ise, aktif kartı sıfırla
                if (state.currentCard && state.currentCard.id === cardId) {
                    state.currentCard = state.cards.length > 0 ? state.cards[0] : null;
                }
                
                // Bu karta ait harcamaları da sil
                state.expenses = state.expenses.filter(expense => expense.cardId !== cardId);
                
                updateUI();
                debugLog(`Kart silindi: ${cardId}`);
            }
        }

        // Harcama sil
        function deleteExpense(expenseId) {
            if (confirm('Bu harcamayı silmek istediğinizden emin misiniz?')) {
                state.expenses = state.expenses.filter(expense => expense.id !== expenseId);
                updateUI();
                debugLog(`Harcama silindi: ${expenseId}`);
            }
        }
    </script>
</body>
</html>
