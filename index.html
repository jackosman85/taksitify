<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taksitify - Finansal Hesaplama ve Analiz Platformu</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --border-radius: 10px;
            --box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ed 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, var(--dark-color) 0%, #1a2530 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }
        
        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar-header h2 i {
            color: var(--primary-color);
        }
        
        .finance-tools {
            margin-top: 30px;
        }
        
        .finance-tools h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: #ecf0f1;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tool-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 12px 15px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tool-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }
        
        .tool-item.active {
            background: var(--primary-color);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            background: #f5f7fa;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .header h1 {
            font-size: 1.8rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-info {
            display: flex;
            gap: 20px;
        }
        
        .info-box {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            flex: 1;
            position: relative;
            transition: var(--transition);
            border-top: 4px solid var(--primary-color);
        }
        
        .info-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .info-box h3 {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .info-box p {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--dark-color);
        }
        
        .limit-bar {
            height: 10px;
            background-color: #eee;
            border-radius: 5px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        .limit-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color) 0%, #27ae60 100%);
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .as-limit-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        .as-limit-section label {
            display: block;
            font-size: 0.8rem;
            color: #777;
            margin-bottom: 5px;
        }
        
        .as-limit-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .as-limit-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .expense-section {
            margin-top: 30px;
        }
        
        .section-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--dark-color);
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .section-title h2 {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .add-expense-form {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-bottom: 25px;
            transition: var(--transition);
        }
        
        .add-expense-form:hover {
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.2);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(52, 152, 219, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color) 0%, #c0392b 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(231, 76, 60, 0.2);
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(231, 76, 60, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #27ae60 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(46, 204, 113, 0.2);
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(46, 204, 113, 0.3);
        }
        
        .expense-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .expense-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            width: 220px;
            position: relative;
            transition: var(--transition);
            border-top: 4px solid var(--warning-color);
        }
        
        .expense-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .expense-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .expense-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--dark-color);
        }
        
        .delete-btn {
            background: none;
            border: none;
            color: var(--danger-color);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .delete-btn:hover {
            background-color: rgba(231, 76, 60, 0.1);
            border-radius: 50%;
            transform: scale(1.1);
        }
        
        .expense-details {
            margin-top: 10px;
        }
        
        .expense-details p {
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }
        
        .expense-details .label {
            color: #777;
            font-weight: 500;
        }
        
        .expense-details .value {
            color: var(--dark-color);
            font-weight: bold;
        }
        
        .months-section {
            margin-top: 30px;
        }
        
        .months-container {
            display: flex;
            overflow-x: auto;
            gap: 20px;
            padding: 15px 0;
        }
        
        .month-column {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            min-width: 220px;
            position: relative;
            transition: var(--transition);
        }
        
        .month-column:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .month-header {
            text-align: center;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            color: var(--dark-color);
            font-size: 1.1rem;
        }
        
        .month-total {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #eee;
            font-weight: bold;
            text-align: center;
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        .expense-item {
            background: #f9f9f9;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            position: relative;
            transition: var(--transition);
        }
        
        .expense-item:hover {
            background: #f0f0f0;
        }
        
        .expense-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 5px;
        }
        
        .expense-item .expense-name {
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .expense-item .expense-amount {
            font-size: 0.9rem;
            color: #e74c3c;
            font-weight: bold;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            width: 480px;
            max-width: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            transform: translateY(-20px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-header h3 {
            font-size: 1.5rem;
            color: var(--dark-color);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #777;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            background-color: rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            color: #333;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 25px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #777;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #ddd;
        }
        
        .finance-calculator {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-top: 30px;
            display: none;
        }
        
        .finance-calculator.active {
            display: block;
        }
        
        .calculator-title {
            font-size: 1.6rem;
            margin-bottom: 25px;
            color: var(--dark-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .calculator-result {
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-color);
        }
        
        .calculator-result h4 {
            margin-bottom: 15px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .useful-sites {
            margin-top: 30px;
        }
        
        .site-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .site-item {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 20px;
            border-top: 4px solid var(--primary-color);
        }
        
        .site-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.1);
        }
        
        .site-logo {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .site-content {
            flex: 1;
        }
        
        .site-item a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            font-size: 1.2rem;
            display: block;
            margin-bottom: 8px;
            transition: var(--transition);
        }
        
        .site-item a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        
        .site-description {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.5;
        }
        
        .month-navigation {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .debug-info {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: var(--border-radius);
            padding: 12px;
            margin-top: 15px;
            font-size: 13px;
            color: #666;
            font-family: monospace;
        }
        
        .card-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .expense-category {
            background-color: #e3f2fd;
            border-radius: 12px;
            padding: 4px 10px;
            font-size: 0.75rem;
            color: #1976d2;
            margin-top: 5px;
            display: inline-block;
        }
        
        .quick-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .quick-action-btn {
            flex: 1;
            padding: 10px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid #dee2e6;
            border-radius: var(--border-radius);
            cursor: pointer;
            text-align: center;
            font-size: 0.9rem;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .quick-action-btn:hover {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        /* Tool Section Styles */
        .tool-section {
            display: none;
        }
        
        .tool-section.active {
            display: block;
        }

        /* Enflasyon Tablosu */
        .inflation-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }
        
        .inflation-table th,
        .inflation-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .inflation-table th {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            font-weight: 500;
        }
        
        .inflation-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .inflation-table .tuk {
            color: #3498db;
            font-weight: bold;
        }
        
        .inflation-table .ito {
            color: #2ecc71;
            font-weight: bold;
        }
        
        .inflation-table .enag {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .chart-comparison {
            margin-top: 35px;
        }
        
        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            font-weight: 500;
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }

        /* Getiri Hesaplama Styles */
        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 25px;
        }
        
        .calculator-inputs {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .calculator-results {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
            padding-bottom: 18px;
            border-bottom: 1px solid #eee;
        }
        
        .result-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .result-label {
            font-weight: 500;
            color: #666;
        }
        
        .result-value {
            font-weight: bold;
            font-size: 1.15rem;
            color: var(--primary-color);
        }
        
        .result-highlight {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            padding: 20px;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--secondary-color);
            margin-top: 20px;
        }

        /* Yeni Getiri Hesaplama Stilleri */
        .period-selector {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .period-select {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .period-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .period-input {
            flex: 1;
        }
        
        .enag-info {
            font-size: 0.85rem;
            color: #e74c3c;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .inflation-info {
            font-size: 0.85rem;
            color: #3498db;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Getiri Grafikleri */
        .return-charts {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin-top: 35px;
        }
        
        .chart-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .chart-title {
            text-align: center;
            margin-bottom: 20px;
            color: #444;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        /* Yığılmış (Stacked) Bar Chart için özel stiller */
        .stacked-bar-legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stacked-legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            font-weight: 500;
        }

        /* Stopaj için ek stiller */
        .stopaj-section {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 1px solid #ffeaa7;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
        }
        
        .stopaj-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            cursor: pointer;
        }
        
        .stopaj-toggle input {
            width: 20px;
            height: 20px;
        }
        
        .stopaj-content {
            display: none;
            margin-top: 15px;
        }
        
        .stopaj-content.active {
            display: block;
        }
        
        .stopaj-info {
            font-size: 0.85rem;
            color: #856404;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .tax-breakdown {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #e74c3c;
        }
        
        .tax-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .tax-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .tax-label {
            font-weight: 500;
            color: #666;
        }
        
        .tax-value {
            font-weight: bold;
            color: #e74c3c;
        }
        
        .net-return {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-top: 20px;
            border-left: 4px solid var(--secondary-color);
        }

        /* Aylık Bütçe Sayfası için Yeni Stiller */
        .budget-container {
            display: flex;
            gap: 25px;
            margin-top: 25px;
        }
        
        .budget-column {
            flex: 1;
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .budget-column.income {
            border-top: 4px solid var(--secondary-color);
        }
        
        .budget-column.expense {
            border-top: 4px solid var(--danger-color);
        }
        
        .budget-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        
        .budget-header h3 {
            font-size: 1.4rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .budget-total {
            text-align: center;
            font-size: 1.6rem;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: var(--border-radius);
        }
        
        .income-total {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            color: var(--secondary-color);
        }
        
        .expense-total {
            background: linear-gradient(135deg, #ffeaea 0%, #f8d7da 100%);
            color: var(--danger-color);
        }
        
        .budget-items {
            min-height: 200px;
            margin-bottom: 25px;
        }
        
        .budget-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
            border-left: 4px solid transparent;
        }
        
        .income-item {
            border-left-color: var(--secondary-color);
        }
        
        .expense-item {
            border-left-color: var(--danger-color);
        }
        
        .budget-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .item-content {
            flex: 1;
        }
        
        .item-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--dark-color);
        }
        
        .item-amount {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .income-amount {
            color: var(--secondary-color);
        }
        
        .expense-amount {
            color: var(--danger-color);
        }
        
        .item-delete {
            background: none;
            border: none;
            color: #777;
            cursor: pointer;
            font-size: 1.1rem;
            padding: 5px;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .item-delete:hover {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger-color);
        }
        
        .budget-summary {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-top: 25px;
            text-align: center;
        }
        
        .net-amount {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 15px 0;
            padding: 20px;
            border-radius: var(--border-radius);
        }
        
        .positive {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            color: var(--secondary-color);
        }
        
        .negative {
            background: linear-gradient(135deg, #ffeaea 0%, #f8d7da 100%);
            color: var(--danger-color);
        }
        
        .neutral {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            color: var(--primary-color);
        }
        
        .budget-form {
            background: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
        }
        
        .form-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .form-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }
        
        .form-tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .form-tab.income-tab.active {
            border-bottom-color: var(--secondary-color);
            color: var(--secondary-color);
        }
        
        .form-tab.expense-tab.active {
            border-bottom-color: var(--danger-color);
            color: var(--danger-color);
        }
        
        .budget-form-content {
            display: none;
        }
        
        .budget-form-content.active {
            display: block;
        }
        
        .empty-budget {
            text-align: center;
            padding: 40px 20px;
            color: #777;
        }
        
        .empty-budget i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #ddd;
        }

        /* Kart Ekleme Butonu Taksit Sayfasında */
        .add-card-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-bottom: 25px;
        }
        
        .add-card-btn {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 12px 20px;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: var(--transition);
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.2);
            width: 100%;
        }
        
        .add-card-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(52, 152, 219, 0.3);
        }

        /* Kart Seçim Bölümü */
        .card-selection {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-bottom: 25px;
        }
        
        .card-selection h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        
        .card-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: var(--border-radius);
            padding: 15px;
            cursor: pointer;
            transition: var(--transition);
            border-left: 4px solid transparent;
            flex: 1;
            min-width: 200px;
            position: relative;
        }
        
        .card-item:hover {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            transform: translateY(-2px);
        }
        
        .card-item.active {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 4px solid var(--primary-color);
        }
        
        .card-delete-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: none;
            border: none;
            color: #777;
            cursor: pointer;
            font-size: 1rem;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .card-delete-btn:hover {
            background-color: var(--danger-color);
            color: white;
            transform: scale(1.1);
        }

        /* Rapor Düğmeleri için Stiller */
        .report-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: flex-end;
        }
        
        .report-btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .report-btn-pdf {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(231, 76, 60, 0.2);
        }
        
        .report-btn-excel {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(46, 204, 113, 0.2);
        }
        
        .report-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
        }
        
        .report-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-top: 30px;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        
        .report-title {
            font-size: 1.4rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .report-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .report-summary-item {
            background: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 15px;
            text-align: center;
        }
        
        .report-summary-label {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 8px;
        }
        
        .report-summary-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--dark-color);
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .report-table th,
        .report-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .report-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .report-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .report-footer {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            text-align: center;
            color: #777;
            font-size: 0.9rem;
        }

        /* Responsive Tasarım */
        @media (max-width: 1200px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }
            
            .card-info {
                flex-direction: column;
            }
            
            .budget-container {
                flex-direction: column;
            }
        }
        
        @media (max-width: 992px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .form-row {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
                align-items: flex-start;
            }
            
            .card-info {
                width: 100%;
            }
            
            .expense-cards {
                justify-content: center;
            }
            
            .site-list {
                grid-template-columns: 1fr;
            }
            
            .month-navigation {
                flex-wrap: wrap;
            }
            
            .report-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sol Menü - Finansal Araçlar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-chart-line"></i> Taksitify</h2>
            </div>
            
            <div class="finance-tools">
                <h3><i class="fas fa-tools"></i> Finansal Araçlar</h3>
                <div class="tool-item active" data-tool="taksit">
                    <i class="fas fa-calculator"></i> Taksit Hesaplama
                </div>
                <div class="tool-item" data-tool="getiri">
                    <i class="fas fa-chart-line"></i> Getiri Hesaplama
                </div>
                <div class="tool-item" data-tool="monthly-budget">
                    <i class="fas fa-wallet"></i> Aylık Bütçe
                </div>
                <div class="tool-item" data-tool="inflation">
                    <i class="fas fa-chart-bar"></i> Enflasyon Verileri
                </div>
                <div class="tool-item" data-tool="useful-sites">
                    <i class="fas fa-link"></i> Yararlı Siteler
                </div>
            </div>
        </div>
        
        <!-- Ana İçerik -->
        <div class="main-content">
            <!-- Taksit Hesaplama Bölümü -->
            <div id="taksit-section" class="tool-section active">
                <div class="header">
                    <h1><i class="fas fa-credit-card"></i> <span id="currentCardName">Kart Seçin</span></h1>
                    <div class="card-info">
                        <div class="info-box">
                            <h3><i class="fas fa-money-bill-wave"></i> Kullanılabilir Limit</h3>
                            <p id="availableLimit">0 TL</p>
                            <div class="limit-bar">
                                <div class="limit-fill" id="limitFill" style="width: 0%"></div>
                            </div>
                            <div class="as-limit-section">
                                <label for="asLimitInput"><i class="fas fa-cog"></i> As Limit (TL):</label>
                                <input type="number" id="asLimitInput" class="as-limit-input" placeholder="As limit girin" value="25000">
                            </div>
                        </div>
                        <div class="info-box">
                            <h3><i class="fas fa-file-invoice-dollar"></i> Toplam Borç</h3>
                            <p id="totalDebt">0 TL</p>
                        </div>
                        <div class="info-box">
                            <h3><i class="fas fa-hand-holding-usd"></i> Asgari Ödeme</h3>
                            <p id="minPayment">0 TL</p>
                        </div>
                    </div>
                </div>
                
                <!-- Kart Yönetim Bölümü -->
                <div class="card-selection">
                    <h3><i class="fas fa-credit-card"></i> Kart Yönetimi</h3>
                    <button class="add-card-btn" id="addCardBtn">
                        <i class="fas fa-plus-circle"></i> Yeni Kart Ekle
                    </button>
                    
                    <div class="card-list" id="cardList">
                        <!-- Kartlar buraya eklenecek -->
                    </div>
                </div>
                
                <!-- Hızlı İşlemler -->
                <div class="quick-actions">
                    <button class="quick-action-btn" data-amount="500">500 TL</button>
                    <button class="quick-action-btn" data-amount="1000">1000 TL</button>
                    <button class="quick-action-btn" data-amount="2000">2000 TL</button>
                    <button class="quick-action-btn" data-amount="5000">5000 TL</button>
                </div>
                
                <!-- Harcama Ekleme Bölümü -->
                <div class="expense-section">
                    <div class="section-title">
                        <h2><i class="fas fa-shopping-cart"></i> Harcamalar</h2>
                    </div>
                    
                    <div class="add-expense-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expenseName"><i class="fas fa-tag"></i> Harcama Adı</label>
                                <input type="text" id="expenseName" class="form-control" placeholder="Harcama adını girin" value="Test Harcama">
                            </div>
                            <div class="form-group">
                                <label for="expenseAmount"><i class="fas fa-money-bill"></i> Harcama Tutarı (TL)</label>
                                <input type="number" id="expenseAmount" class="form-control" placeholder="Tutar girin" value="1000">
                            </div>
                            <div class="form-group">
                                <label for="installmentCount"><i class="fas fa-calendar-alt"></i> Taksit Sayısı</label>
                                <input type="number" id="installmentCount" class="form-control" placeholder="Taksit sayısı" min="1" value="3">
                            </div>
                        </div>
                        <button class="btn btn-primary" id="addExpenseBtn">
                            <i class="fas fa-plus-circle"></i> Harcama Ekle
                        </button>
                        <div class="debug-info" id="debugInfo">
                            Durum: Taksitify yüklendi. Kart ekleyerek başlayın.
                        </div>
                    </div>
                    
                    <div class="expense-cards" id="expenseCards">
                        <div class="empty-state">
                            <i class="fas fa-receipt"></i>
                            <h3>Henüz harcama eklenmemiş</h3>
                            <p>Yukarıdaki formu kullanarak ilk harcamanızı ekleyin</p>
                        </div>
                    </div>
                </div>
                
                <!-- Aylık Ödeme Tablosu -->
                <div class="months-section">
                    <div class="section-title">
                        <h2><i class="fas fa-calendar-check"></i> Aylık Ödemeler</h2>
                        <div class="month-navigation">
                            <button class="btn btn-primary" id="prevMonthsBtn">
                                <i class="fas fa-chevron-left"></i> Önceki
                            </button>
                            <span id="monthRange">Aylar 1-6</span>
                            <button class="btn btn-primary" id="nextMonthsBtn">
                                Sonraki <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="months-container" id="monthsContainer">
                        <div class="empty-state">
                            <i class="fas fa-calendar-times"></i>
                            <h3>Henüz harcama eklenmemiş</h3>
                            <p>Harcama ekleyin ve aylara dağıtılsın</p>
                        </div>
                    </div>
                </div>
                
                <!-- Yeni Eklenen Rapor Bölümü -->
                <div class="report-section">
                    <div class="report-header">
                        <h2 class="report-title"><i class="fas fa-file-alt"></i> Taksit Raporu</h2>
                        <div class="report-actions">
                            <button class="report-btn report-btn-pdf" id="generatePdfReport">
                                <i class="fas fa-file-pdf"></i> PDF Raporu İndir
                            </button>
                            <button class="report-btn report-btn-excel" id="generateExcelReport">
                                <i class="fas fa-file-excel"></i> Excel Raporu İndir
                            </button>
                        </div>
                    </div>
                    
                    <div class="report-summary" id="taksitReportSummary">
                        <!-- Rapor özeti burada oluşturulacak -->
                    </div>
                    
                    <div class="report-content">
                        <h3><i class="fas fa-list"></i> Harcama Detayları</h3>
                        <table class="report-table" id="taksitReportTable">
                            <thead>
                                <tr>
                                    <th>Harcama Adı</th>
                                    <th>Tutar</th>
                                    <th>Taksit Sayısı</th>
                                    <th>Toplam</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Harcama detayları burada oluşturulacak -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="report-footer">
                        <p><i class="fas fa-info-circle"></i> Bu rapor Taksitify tarafından oluşturulmuştur. Tarih: <span id="reportDate"></span></p>
                    </div>
                </div>
            </div>

            <!-- Getiri Hesaplama Bölümü -->
            <div id="getiri-section" class="tool-section">
                <div class="header">
                    <h1><i class="fas fa-chart-line"></i> Getiri Hesaplama</h1>
                </div>
                
                <div class="finance-calculator active">
                    <div class="calculator-title">
                        <i class="fas fa-chart-line"></i> Yatırım Getirisi Hesaplayıcı
                    </div>
                    
                    <div class="calculator-grid">
                        <div class="calculator-inputs">
                            <div class="form-group">
                                <label for="initialPrice"><i class="fas fa-coins"></i> İlk Fiyat (TL)</label>
                                <input type="number" id="initialPrice" class="form-control" value="1000" min="0" step="0.01">
                            </div>
                            
                            <div class="form-group">
                                <label for="finalPrice"><i class="fas fa-money-bill-wave"></i> Son Fiyat (TL)</label>
                                <input type="number" id="finalPrice" class="form-control" value="1500" min="0" step="0.01">
                            </div>
                            
                            <div class="form-group">
                                <label for="periodValue"><i class="fas fa-clock"></i> Zaman Periyodu</label>
                                <div class="period-selector">
                                    <input type="number" id="periodValue" class="form-control period-input" value="1" min="1">
                                    <select id="periodType" class="period-select">
                                        <option value="daily">Günlük</option>
                                        <option value="monthly" selected>Aylık</option>
                                        <option value="yearly">Yıllık</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="inflationRate"><i class="fas fa-chart-bar"></i> Enflasyon Oranı (%)</label>
                                <input type="number" id="inflationRate" class="form-control" value="3.79" step="0.01">
                                <div class="enag-info">
                                    <i class="fas fa-info-circle"></i> ENAG Enflasyonu: %3.79 (Eylül 2025)
                                </div>
                                <div class="inflation-info" id="periodInflationInfo">
                                    <i class="fas fa-info-circle"></i> Aylık Enflasyon: %3.79
                                </div>
                            </div>
                            
                            <!-- MANUEL STOPAJ GİRİŞİ -->
                            <div class="stopaj-section">
                                <div class="stopaj-toggle">
                                    <input type="checkbox" id="stopajToggle">
                                    <label for="stopajToggle" style="font-weight: bold; color: #856404;">
                                        <i class="fas fa-percentage"></i> Stopaj Hesaplaması Ekle
                                    </label>
                                </div>
                                
                                <div class="stopaj-content" id="stopajContent">
                                    <div class="form-group">
                                        <label for="stopajOrani"><i class="fas fa-receipt"></i> Stopaj Oranı (%)</label>
                                        <input type="number" id="stopajOrani" class="form-control" value="10" step="0.01" min="0" max="100">
                                        <div class="stopaj-info">
                                            <i class="fas fa-lightbulb"></i> Stopaj oranını manuel olarak girin (Türkiye'de mevduat faizi stopaj oranı: %10)
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="btn btn-success" id="calculateReturnBtn" style="width: 100%;">
                                <i class="fas fa-calculator"></i> Getiriyi Hesapla
                            </button>
                        </div>
                        
                        <div class="calculator-results">
                            <h4><i class="fas fa-list-alt"></i> Hesaplama Sonuçları</h4>
                            
                            <div class="result-item">
                                <span class="result-label">Nominal Getiri:</span>
                                <span class="result-value" id="nominalReturn">500 TL</span>
                            </div>
                            
                            <div class="result-item">
                                <span class="result-label">Nominal Getiri Oranı:</span>
                                <span class="result-value" id="nominalReturnRate">50.00%</span>
                            </div>
                            
                            <div class="result-item">
                                <span class="result-label">Yıllık Getiri Oranı:</span>
                                <span class="result-value" id="annualReturnRate">50.00%</span>
                            </div>
                            
                            <!-- STOPAJ DETAYLARI -->
                            <div class="tax-breakdown" id="taxBreakdown" style="display: none;">
                                <h5 style="margin-bottom: 15px; color: #e74c3c;">
                                    <i class="fas fa-receipt"></i> Vergi Kesintileri
                                </h5>
                                
                                <div class="tax-item">
                                    <span class="tax-label">Stopaj Oranı:</span>
                                    <span class="tax-value" id="stopajOraniDisplay">%10</span>
                                </div>
                                
                                <div class="tax-item">
                                    <span class="tax-label">Stopaj Tutarı:</span>
                                    <span class="tax-value" id="stopajTutari">50 TL</span>
                                </div>
                                
                                <div class="tax-item">
                                    <span class="tax-label">Net Getiri (Vergi Sonrası):</span>
                                    <span class="tax-value" id="netGetiri">450 TL</span>
                                </div>
                            </div>
                            
                            <!-- REEL GETİRİ ARTIK NET KAZANCIN ENFLASYONDAN ARINDIRILMIŞ HALİ -->
                            <div class="result-highlight">
                                <div class="result-item">
                                    <span class="result-label">Reel Getiri (Net Kazancın Enflasyondan Arındırılmış Hali):</span>
                                    <span class="result-value" id="realReturn">442.10 TL</span>
                                </div>
                            </div>
                            
                            <div class="result-item">
                                <span class="result-label">Reel Getiri Oranı:</span>
                                <span class="result-value" id="realReturnRate">44.21%</span>
                            </div>
                            
                            <div class="result-item">
                                <span class="result-label">Satın Alma Gücü Artışı:</span>
                                <span class="result-value" id="purchasingPower">44.21%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Getiri Grafikleri -->
                    <div class="return-charts">
                        <div class="chart-container">
                            <h3 class="chart-title">Getiri Karşılaştırması</h3>
                            <div class="chart-wrapper">
                                <canvas id="returnChart"></canvas>
                            </div>
                            <div class="stacked-bar-legend" id="stackedLegend"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aylık Bütçe Hesaplayıcı Bölümü -->
            <div id="monthly-budget-section" class="tool-section">
                <div class="header">
                    <h1><i class="fas fa-wallet"></i> Aylık Bütçe Hesaplayıcı</h1>
                </div>
                
                <div class="finance-calculator active">
                    <div class="calculator-title">
                        <i class="fas fa-calculator"></i> Aylık Bütçe Planlayıcı
                    </div>
                    
                    <!-- Bütçe Formu -->
                    <div class="budget-form">
                        <div class="form-tabs">
                            <button class="form-tab income-tab active" data-type="income">
                                <i class="fas fa-plus-circle"></i> Gelir Kalemi Ekle
                            </button>
                            <button class="form-tab expense-tab" data-type="expense">
                                <i class="fas fa-minus-circle"></i> Gider Kalemi Ekle
                            </button>
                        </div>
                        
                        <!-- Gelir Formu -->
                        <div class="budget-form-content active" id="income-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="incomeName"><i class="fas fa-tag"></i> Gelir Kalemi Adı</label>
                                    <input type="text" id="incomeName" class="form-control" placeholder="Maaş, yatırım geliri, vb.">
                                </div>
                                <div class="form-group">
                                    <label for="incomeAmount"><i class="fas fa-money-bill-wave"></i> Tutar (TL)</label>
                                    <input type="number" id="incomeAmount" class="form-control" placeholder="Gelir tutarını girin" min="0" step="0.01">
                                </div>
                            </div>
                            <button class="btn btn-success" id="addIncomeBtnBudget">
                                <i class="fas fa-plus"></i> Gelir Ekle
                            </button>
                        </div>
                        
                        <!-- Gider Formu -->
                        <div class="budget-form-content" id="expense-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expenseNameBudget"><i class="fas fa-tag"></i> Gider Kalemi Adı</label>
                                    <input type="text" id="expenseNameBudget" class="form-control" placeholder="Kira, faturalar, market, vb.">
                                </div>
                                <div class="form-group">
                                    <label for="expenseAmountBudget"><i class="fas fa-money-bill-wave"></i> Tutar (TL)</label>
                                    <input type="number" id="expenseAmountBudget" class="form-control" placeholder="Gider tutarını girin" min="0" step="0.01">
                                </div>
                            </div>
                            <button class="btn btn-danger" id="addExpenseBtnBudget">
                                <i class="fas fa-plus"></i> Gider Ekle
                            </button>
                        </div>
                    </div>
                    
                    <!-- T-Muhasebe Görünümü -->
                    <div class="budget-container">
                        <!-- Gelir Kolonu (Sol) -->
                        <div class="budget-column income">
                            <div class="budget-header">
                                <h3><i class="fas fa-arrow-down"></i> GELİRLER</h3>
                            </div>
                            
                            <div class="budget-items" id="incomeItems">
                                <div class="empty-budget">
                                    <i class="fas fa-coins"></i>
                                    <h4>Henüz gelir eklenmemiş</h4>
                                    <p>Yukarıdaki formu kullanarak gelir ekleyin</p>
                                </div>
                            </div>
                            
                            <div class="budget-total income-total" id="incomeTotal">
                                Toplam Gelir: 0 TL
                            </div>
                        </div>
                        
                        <!-- Gider Kolonu (Sağ) -->
                        <div class="budget-column expense">
                            <div class="budget-header">
                                <h3><i class="fas fa-arrow-up"></i> GİDERLER</h3>
                            </div>
                            
                            <div class="budget-items" id="expenseItems">
                                <div class="empty-budget">
                                    <i class="fas fa-shopping-cart"></i>
                                    <h4>Henüz gider eklenmemiş</h4>
                                    <p>Yukarıdaki formu kullanarak gider ekleyin</p>
                                </div>
                            </div>
                            
                            <div class="budget-total expense-total" id="expenseTotal">
                                Toplam Gider: 0 TL
                            </div>
                        </div>
                    </div>
                    
                    <!-- Net Bakiye Özetı -->
                    <div class="budget-summary">
                        <h3><i class="fas fa-scale-balanced"></i> Bütçe Özeti</h3>
                        <div class="net-amount neutral" id="netAmount">
                            Net Bakiye: 0 TL
                        </div>
                        <p id="budgetStatus">Gelir ve giderlerinizi ekleyerek bütçenizi görün</p>
                    </div>
                </div>
            </div>

            <!-- Enflasyon Verileri Bölümü -->
            <div id="inflation-section" class="tool-section">
                <div class="header">
                    <h1><i class="fas fa-chart-bar"></i> Enflasyon Verileri</h1>
                </div>
                
                <div class="finance-calculator active">
                    <div class="calculator-title">
                        <i class="fas fa-chart-line"></i> 2025 Yılı Enflasyon Verileri
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="inflationChart"></canvas>
                        <div class="chart-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #3498db;"></div>
                                <span>TÜİK</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #2ecc71;"></div>
                                <span>İTO</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #e74c3c;"></div>
                                <span>ENAG</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-comparison">
                        <h3>2025 Yılı Aylık Enflasyon Verileri</h3>
                        <table class="inflation-table">
                            <thead>
                                <tr>
                                    <th>Ay</th>
                                    <th>TÜİK (%)</th>
                                    <th>İTO (%)</th>
                                    <th>ENAG (%)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Eylül 2025</td>
                                    <td class="tuk">3,23</td>
                                    <td class="ito">3,19</td>
                                    <td class="enag">3,79</td>
                                </tr>
                                <tr>
                                    <td>Ağustos 2025</td>
                                    <td class="tuk">2,04</td>
                                    <td class="ito">1,84</td>
                                    <td class="enag">3,23</td>
                                </tr>
                                <tr>
                                    <td>Temmuz 2025</td>
                                    <td class="tuk">2,06</td>
                                    <td class="ito">2,62</td>
                                    <td class="enag">3,75</td>
                                </tr>
                                <tr>
                                    <td>Haziran 2025</td>
                                    <td class="tuk">1,37</td>
                                    <td class="ito">1,77</td>
                                    <td class="enag">3,05</td>
                                </tr>
                                <tr>
                                    <td>Mayıs 2025</td>
                                    <td class="tuk">1,53</td>
                                    <td class="ito">2,83</td>
                                    <td class="enag">3,66</td>
                                </tr>
                                <tr>
                                    <td>Nisan 2025</td>
                                    <td class="tuk">3,00</td>
                                    <td class="ito">3,21</td>
                                    <td class="enag">4,46</td>
                                </tr>
                                <tr>
                                    <td>Mart 2025</td>
                                    <td class="tuk">2,46</td>
                                    <td class="ito">3,79</td>
                                    <td class="enag">3,91</td>
                                </tr>
                                <tr>
                                    <td>Şubat 2025</td>
                                    <td class="tuk">2,27</td>
                                    <td class="ito">3,19</td>
                                    <td class="enag">3,37</td>
                                </tr>
                                <tr>
                                    <td>Ocak 2025</td>
                                    <td class="tuk">5,03</td>
                                    <td class="ito">5,16</td>
                                    <td class="enag">8,20</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="calculator-result">
                        <h4><i class="fas fa-info-circle"></i> Enflasyon Verileri Hakkında</h4>
                        <p>Bu grafik ve tablo, TÜİK (Türkiye İstatistik Kurumu), İTO (İstanbul Ticaret Odası) ve ENAG (Enflasyon Araştırma Grubu) tarafından açıklanan 2025 yılı aylık enflasyon verilerini karşılaştırmalı olarak göstermektedir.</p>
                    </div>
                </div>
            </div>

            <!-- Yararlı Siteler Bölümü -->
            <div id="useful-sites-section" class="tool-section">
                <div class="header">
                    <h1><i class="fas fa-link"></i> Yararlı Finans Siteleri</h1>
                </div>
                
                <div class="useful-sites">
                    <div class="site-list">
                        <!-- 1. CNBC-e -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #FF0000, #8B0000);">
                                <i class="fab fa-youtube"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://www.youtube.com/@cnbce" target="_blank">CNBC-e - YouTube Kanalı</a>
                                <div class="site-description">Ekonomi ve iş dünyasından güncel haberler ve analizler</div>
                            </div>
                        </div>
                        
                        <!-- 2. Donanımhaber Forum -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #1e88e5, #0d47a1);">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://forum.donanimhaber.com/yatirim-fonlari-bes-fonlari-ana-konu--147353253" target="_blank">Donanımhaber Yatırım Fonları Forumu</a>
                                <div class="site-description">Yatırım fonları ve BES fonları hakkında topluluk tartışmaları</div>
                            </div>
                        </div>
                        
                        <!-- 3. Cihat E. Çiçek -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #FF0000, #CC0000);">
                                <i class="fab fa-youtube"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://www.youtube.com/@cihatecicek" target="_blank">Cihat E. Çiçek - YouTube Kanalı</a>
                                <div class="site-description">Finans, ekonomi ve yatırım konularında eğitici içerikler</div>
                            </div>
                        </div>
                        
                        <!-- 4. Fonparam.com -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #4caf50, #2e7d32);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://www.fonparam.com" target="_blank">Fonparam.com</a>
                                <div class="site-description">Yatırım fonları performans takibi ve karşılaştırma platformu</div>
                            </div>
                        </div>
                        
                        <!-- 5. Bankacılık Ürün ve Hizmet Ücretleri -->
                        <div class="site-item">
                            <div class="site-logo" style="background: linear-gradient(45deg, #9c27b0, #6a1b9a);">
                                <i class="fas fa-landmark"></i>
                            </div>
                            <div class="site-content">
                                <a href="https://www.bankacilikurunvehizmetucretleri.org.tr" target="_blank">Bankacılık Ürün ve Hizmet Ücretleri</a>
                                <div class="site-description">Bankacılık ürünleri ve hizmet ücretleri karşılaştırma platformu</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Kart Ekleme Modal -->
    <div class="modal" id="addCardModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Yeni Kart Ekle</h3>
                <button class="close-modal" id="closeModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="modalCardName"><i class="fas fa-credit-card"></i> Kart Adı</label>
                    <input type="text" id="modalCardName" class="form-control" placeholder="Kart adını girin">
                </div>
                <div class="form-group">
                    <label for="modalAsLimit"><i class="fas fa-cog"></i> As Limit (TL)</label>
                    <input type="number" id="modalAsLimit" class="form-control" placeholder="As limit girin" value="25000">
                </div>
                <div class="form-group">
                    <label for="modalCardLimit"><i class="fas fa-money-bill-wave"></i> Kullanılabilir Limit (TL)</label>
                    <input type="number" id="modalCardLimit" class="form-control" placeholder="Kart limitini girin">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelAddCardBtn">
                    <i class="fas fa-times"></i> İptal
                </button>
                <button class="btn btn-success" id="confirmAddCardBtn">
                    <i class="fas fa-check"></i> Kart Ekle
                </button>
            </div>
        </div>
    </div>

    <script>
        // DEBUG: Hata ayıklama için konsol çıktısı
        function debugLog(message) {
            console.log(`[Taksitify] ${message}`);
            const debugInfo = document.getElementById('debugInfo');
            if (debugInfo) {
                debugInfo.textContent = `Durum: ${message}`;
            }
        }

        // Uygulama durumu
        const state = {
            cards: [],
            currentCard: null,
            expenses: [],
            months: [],
            payments: [],
            currentTool: 'taksit',
            currentMonthIndex: 0,
            monthsPerView: 6,
            asLimit: 25000
        };

        // Bütçe veri yapısı
        const budgetState = {
            incomes: [],
            expenses: [],
            currentMonth: new Date().toLocaleDateString('tr-TR', { month: 'long', year: 'numeric' })
        };

        // Enflasyon verileri
        const inflationData = {
            months: ['Ocak 2025', 'Şubat 2025', 'Mart 2025', 'Nisan 2025', 'Mayıs 2025', 'Haziran 2025', 'Temmuz 2025', 'Ağustos 2025', 'Eylül 2025'],
            tuk: [5.03, 2.27, 2.46, 3.00, 1.53, 1.37, 2.06, 2.04, 3.23],
            ito: [5.16, 3.19, 3.79, 3.21, 2.83, 1.77, 2.62, 1.84, 3.19],
            enag: [8.20, 3.37, 3.91, 4.46, 3.66, 3.05, 3.75, 3.23, 3.79]
        };

        // Ay isimleri
        const monthNames = [
            "Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran",
            "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"
        ];

        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('Taksitify başlatılıyor...');
            initializeApp();
            setupEventListeners();
            renderInflationChart();
            setupInvestmentCalculator();
            setupStopajToggle();
            generateMonths();
            setupBudgetPage();
            
            // Rapor düğmelerine event listener'lar ekle
            document.getElementById('generatePdfReport').addEventListener('click', generatePdfReport);
            document.getElementById('generateExcelReport').addEventListener('click', generateExcelReport);
            
            // Rapor tarihini ayarla
            document.getElementById('reportDate').textContent = new Date().toLocaleDateString('tr-TR');
            
            // İlk raporu oluştur
            updateTaksitReport();
        });

        // Stopaj toggle ayarları
        function setupStopajToggle() {
            const stopajToggle = document.getElementById('stopajToggle');
            const stopajContent = document.getElementById('stopajContent');
            
            if (stopajToggle && stopajContent) {
                stopajToggle.addEventListener('change', function() {
                    if (this.checked) {
                        stopajContent.classList.add('active');
                        debugLog('Stopaj hesaplaması aktifleştirildi');
                    } else {
                        stopajContent.classList.remove('active');
                        debugLog('Stopaj hesaplaması devre dışı bırakıldı');
                    }
                    calculateInvestmentReturn();
                });
            }
        }

        // Uygulamayı başlat
        function initializeApp() {
            debugLog('Özellikler yükleniyor...');
            
            // Tool seçimini ayarla
            setupToolSelection();
            
            debugLog('Taksitify hazır!');
        }

        // Event listener'ları kur
        function setupEventListeners() {
            debugLog('Event listenerlar kuruluyor...');
            
            // Kart ekle butonu - Modal aç
            document.getElementById('addCardBtn').addEventListener('click', function() {
                debugLog('Kart ekle butonuna tıklandı, modal açılıyor');
                openAddCardModal();
            });
            
            // Modal kapatma butonları
            document.getElementById('closeModalBtn').addEventListener('click', closeAddCardModal);
            document.getElementById('cancelAddCardBtn').addEventListener('click', closeAddCardModal);
            
            // Kart ekleme onay butonu
            document.getElementById('confirmAddCardBtn').addEventListener('click', function() {
                debugLog('Kart ekleme onay butonuna tıklandı');
                confirmAddCard();
            });
            
            // Modal dışına tıklayarak kapatma
            document.getElementById('addCardModal').addEventListener('click', function(e) {
                if (e.target === document.getElementById('addCardModal')) {
                    closeAddCardModal();
                }
            });
            
            // Harcama ekle butonu
            document.getElementById('addExpenseBtn').addEventListener('click', function(e) {
                debugLog('Harcama ekle butonuna tıklandı');
                addExpense();
            });
            
            // Ay navigasyon butonları
            document.getElementById('prevMonthsBtn').addEventListener('click', function() {
                if (state.currentMonthIndex > 0) {
                    state.currentMonthIndex--;
                    renderMonthColumns();
                }
            });
            
            document.getElementById('nextMonthsBtn').addEventListener('click', function() {
                if (state.currentMonthIndex + state.monthsPerView < state.months.length) {
                    state.currentMonthIndex++;
                    renderMonthColumns();
                }
            });
            
            // As Limit input değişikliği
            document.getElementById('asLimitInput').addEventListener('change', function() {
                const newAsLimit = parseFloat(document.getElementById('asLimitInput').value);
                if (!isNaN(newAsLimit) && newAsLimit > 0) {
                    state.asLimit = newAsLimit;
                    updateUI();
                    debugLog(`As Limit güncellendi: ${state.asLimit} TL`);
                } else {
                    alert('Lütfen geçerli bir As Limit değeri girin.');
                    document.getElementById('asLimitInput').value = state.asLimit;
                }
            });
            
            // Hızlı işlem butonlarını ayarla
            setupQuickActions();
            
            debugLog('Event listenerlar kuruldu');
        }

        // Getiri Hesaplama fonksiyonlarını kur
        function setupInvestmentCalculator() {
            // Getiri hesaplama butonu
            const calculateReturnBtn = document.getElementById('calculateReturnBtn');
            if (calculateReturnBtn) {
                calculateReturnBtn.addEventListener('click', calculateInvestmentReturn);
                
                // Zaman periyodu değişikliği
                document.getElementById('periodType').addEventListener('change', updateInflationRate);
                document.getElementById('periodValue').addEventListener('input', updateInflationRate);
                
                // İlk hesaplamayı yap
                updateInflationRate();
                calculateInvestmentReturn();
                
                debugLog('Getiri hesaplama fonksiyonları kuruldu');
            }
        }

        // Bütçe sayfasını kur
        function setupBudgetPage() {
            // Form tab'larını ayarla
            const formTabs = document.querySelectorAll('.form-tab');
            formTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const type = this.dataset.type;
                    
                    // Aktif tab'ı değiştir
                    formTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // İlgili formu göster
                    document.querySelectorAll('.budget-form-content').forEach(form => {
                        form.classList.remove('active');
                    });
                    document.getElementById(`${type}-form`).classList.add('active');
                });
            });
            
            // Gelir ekle butonu
            const addIncomeBtn = document.getElementById('addIncomeBtnBudget');
            if (addIncomeBtn) {
                addIncomeBtn.addEventListener('click', function() {
                    addBudgetItem('income');
                });
            }
            
            // Gider ekle butonu
            const addExpenseBtn = document.getElementById('addExpenseBtnBudget');
            if (addExpenseBtn) {
                addExpenseBtn.addEventListener('click', function() {
                    addBudgetItem('expense');
                });
            }
            
            // Başlangıçta bütçeyi render et
            renderBudget();
            
            debugLog('Bütçe sayfası kuruldu');
        }

        // Bütçe kalemi ekle
        function addBudgetItem(type) {
            const nameInput = document.getElementById(`${type === 'income' ? 'incomeName' : 'expenseNameBudget'}`);
            const amountInput = document.getElementById(`${type === 'income' ? 'incomeAmount' : 'expenseAmountBudget'}`);
            
            if (!nameInput || !amountInput) return;
            
            const name = nameInput.value.trim();
            const amount = parseFloat(amountInput.value);
            
            if (!name) {
                alert(`Lütfen bir ${type === 'income' ? 'gelir' : 'gider'} adı girin.`);
                return;
            }
            
            if (isNaN(amount) || amount <= 0) {
                alert(`Lütfen geçerli bir ${type === 'income' ? 'gelir' : 'gider'} tutarı girin.`);
                return;
            }
            
            // Yeni kalem oluştur
            const newItem = {
                id: Date.now().toString(),
                name: name,
                amount: amount,
                type: type,
                date: new Date()
            };
            
            // State'e ekle
            budgetState[`${type}s`].push(newItem);
            
            // Formu temizle
            nameInput.value = '';
            amountInput.value = '';
            
            // UI'ı güncelle
            renderBudget();
            
            debugLog(`${type === 'income' ? 'Gelir' : 'Gider'} eklendi: ${name} - ${amount} TL`);
        }

        // Bütçeyi render et
        function renderBudget() {
            // Gelirleri render et
            renderBudgetItems('income');
            
            // Giderleri render et
            renderBudgetItems('expense');
            
            // Toplamları güncelle
            updateBudgetTotals();
        }

        // Bütçe kalemlerini render et
        function renderBudgetItems(type) {
            const container = document.getElementById(`${type}Items`);
            if (!container) return;
            
            const items = budgetState[`${type}s`];
            
            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-budget">
                        <i class="fas fa-${type === 'income' ? 'coins' : 'shopping-cart'}"></i>
                        <h4>Henüz ${type === 'income' ? 'gelir' : 'gider'} eklenmemiş</h4>
                        <p>Yukarıdaki formu kullanarak ${type === 'income' ? 'gelir' : 'gider'} ekleyin</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            
            items.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = `budget-item ${type}-item`;
                itemElement.innerHTML = `
                    <div class="item-content">
                        <div class="item-name">${item.name}</div>
                        <div class="item-amount ${type}-amount">${formatCurrency(item.amount)}</div>
                    </div>
                    <button class="item-delete" data-id="${item.id}" data-type="${type}">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                // Silme butonu event listener'ı
                const deleteBtn = itemElement.querySelector('.item-delete');
                deleteBtn.addEventListener('click', function() {
                    deleteBudgetItem(this.dataset.id, this.dataset.type);
                });
                
                container.appendChild(itemElement);
            });
        }

        // Bütçe toplamlarını güncelle
        function updateBudgetTotals() {
            // Toplam gelir
            const totalIncome = budgetState.incomes.reduce((sum, item) => sum + item.amount, 0);
            const incomeTotalEl = document.getElementById('incomeTotal');
            if (incomeTotalEl) {
                incomeTotalEl.textContent = `Toplam Gelir: ${formatCurrency(totalIncome)}`;
            }
            
            // Toplam gider
            const totalExpense = budgetState.expenses.reduce((sum, item) => sum + item.amount, 0);
            const expenseTotalEl = document.getElementById('expenseTotal');
            if (expenseTotalEl) {
                expenseTotalEl.textContent = `Toplam Gider: ${formatCurrency(totalExpense)}`;
            }
            
            // Net bakiye
            const netAmount = totalIncome - totalExpense;
            const netElement = document.getElementById('netAmount');
            const statusElement = document.getElementById('budgetStatus');
            
            if (netElement && statusElement) {
                netElement.textContent = `Net Bakiye: ${formatCurrency(Math.abs(netAmount))}`;
                
                if (netAmount > 0) {
                    netElement.className = 'net-amount positive';
                    statusElement.textContent = `Tebrikler! Bütçenizde ${formatCurrency(netAmount)} fazla var.`;
                } else if (netAmount < 0) {
                    netElement.className = 'net-amount negative';
                    netElement.textContent = `Net Bakiye: -${formatCurrency(Math.abs(netAmount))}`;
                    statusElement.textContent = `Dikkat! Bütçenizde ${formatCurrency(Math.abs(netAmount))} açık var.`;
                } else {
                    netElement.className = 'net-amount neutral';
                    statusElement.textContent = 'Bütçeniz dengede.';
                }
            }
        }

        // Bütçe kalemi sil
        function deleteBudgetItem(id, type) {
            if (confirm('Bu kalemi silmek istediğinizden emin misiniz?')) {
                budgetState[`${type}s`] = budgetState[`${type}s`].filter(item => item.id !== id);
                renderBudget();
                debugLog(`${type === 'income' ? 'Gelir' : 'Gider'} silindi: ${id}`);
            }
        }

        // Enflasyon oranını güncelle
        function updateInflationRate() {
            const periodType = document.getElementById('periodType');
            const periodValue = document.getElementById('periodValue');
            const inflationRate = document.getElementById('inflationRate');
            const periodInflationInfo = document.getElementById('periodInflationInfo');
            
            if (!periodType || !periodValue || !inflationRate || !periodInflationInfo) return;
            
            const periodTypeValue = periodType.value;
            const periodValueNum = parseFloat(periodValue.value);
            const monthlyInflation = 3.79; // ENAG Eylül 2025 aylık enflasyonu
            
            let periodInflation, inflationInfo;
            
            switch(periodTypeValue) {
                case 'daily':
                    // Günlük enflasyon = Aylık enflasyon / 30
                    periodInflation = monthlyInflation / 30;
                    inflationInfo = `Günlük Enflasyon: ${periodInflation.toFixed(2)}%`;
                    break;
                case 'monthly':
                    // Aylık enflasyon = ENAG aylık enflasyonu
                    periodInflation = monthlyInflation;
                    inflationInfo = `Aylık Enflasyon: ${periodInflation.toFixed(2)}%`;
                    break;
                case 'yearly':
                    // Yıllık enflasyon = Aylık enflasyon * 12
                    periodInflation = monthlyInflation * 12;
                    inflationInfo = `Yıllık Enflasyon: ${periodInflation.toFixed(2)}%`;
                    break;
            }
            
            // Dönem enflasyonunu hesapla (bileşik)
            const periodTotalInflation = periodInflation * periodValueNum;
            
            inflationRate.value = periodTotalInflation.toFixed(2);
            periodInflationInfo.textContent = inflationInfo;
            
            debugLog(`Enflasyon oranı güncellendi: ${periodTypeValue} - ${periodTotalInflation.toFixed(2)}%`);
        }

        // Getiri hesapla
        function calculateInvestmentReturn() {
            debugLog('Getiri hesaplama başlatıldı');
            
            const initialPrice = document.getElementById('initialPrice');
            const finalPrice = document.getElementById('finalPrice');
            const periodValue = document.getElementById('periodValue');
            const periodType = document.getElementById('periodType');
            const inflationRate = document.getElementById('inflationRate');
            const stopajToggle = document.getElementById('stopajToggle');
            const stopajOrani = document.getElementById('stopajOrani');
            
            if (!initialPrice || !finalPrice || !periodValue || !periodType || !inflationRate) return;
            
            const initialPriceVal = parseFloat(initialPrice.value);
            const finalPriceVal = parseFloat(finalPrice.value);
            const periodValueVal = parseFloat(periodValue.value);
            const periodTypeVal = periodType.value;
            const inflationRateVal = parseFloat(inflationRate.value) / 100;
            const stopajToggleVal = stopajToggle ? stopajToggle.checked : false;
            const stopajOraniVal = stopajOrani ? parseFloat(stopajOrani.value) / 100 : 0;
            
            if (isNaN(initialPriceVal) || isNaN(finalPriceVal) || isNaN(periodValueVal) || isNaN(inflationRateVal)) {
                alert('Lütfen tüm alanları doğru şekilde doldurun.');
                return;
            }
            
            if (initialPriceVal <= 0) {
                alert('İlk fiyat 0\'dan büyük olmalıdır.');
                return;
            }
            
            // Nominal getiri hesaplama
            const nominalReturn = finalPriceVal - initialPriceVal;
            const nominalReturnRate = (nominalReturn / initialPriceVal) * 100;
            
            // Yıllık getiri oranı hesaplama
            let annualReturnRate;
            switch(periodTypeVal) {
                case 'daily':
                    // Günlük getiriyi yıllığa çevir
                    annualReturnRate = nominalReturnRate * 365 / periodValueVal;
                    break;
                case 'monthly':
                    // Aylık getiriyi yıllığa çevir
                    annualReturnRate = nominalReturnRate * 12 / periodValueVal;
                    break;
                case 'yearly':
                    // Yıllık getiri
                    annualReturnRate = nominalReturnRate;
                    break;
            }
            
            // Stopaj hesaplaması
            let stopajTutari = 0;
            let netGetiri = nominalReturn;
            
            if (stopajToggleVal) {
                stopajTutari = nominalReturn * stopajOraniVal;
                netGetiri = nominalReturn - stopajTutari;
                
                // Vergi detaylarını göster
                const taxBreakdown = document.getElementById('taxBreakdown');
                if (taxBreakdown) {
                    taxBreakdown.style.display = 'block';
                    document.getElementById('stopajOraniDisplay').textContent = '%' + (stopajOraniVal * 100).toFixed(2);
                    document.getElementById('stopajTutari').textContent = formatCurrency(stopajTutari);
                    document.getElementById('netGetiri').textContent = formatCurrency(netGetiri);
                }
                
                debugLog(`Stopaj hesaplandı: Stopaj Tutarı: ${stopajTutari.toFixed(2)} TL, Net Getiri: ${netGetiri.toFixed(2)} TL`);
            } else {
                const taxBreakdown = document.getElementById('taxBreakdown');
                if (taxBreakdown) {
                    taxBreakdown.style.display = 'none';
                }
            }
            
            // Reel getiri hesaplama (enflasyondan arındırılmış)
            // DÜZELTME: Reel getiri = Net Getiri - (Net Getiri * Enflasyon Oranı)
            let realReturn, realReturnRate;
            
            if (finalPriceVal > initialPriceVal) {
                // Pozitif getiri durumu
                realReturn = netGetiri - (netGetiri * inflationRateVal);
                realReturnRate = (realReturn / initialPriceVal) * 100;
            } else {
                // Negatif getiri durumu
                realReturn = netGetiri;
                realReturnRate = (realReturn / initialPriceVal) * 100;
            }
            
            // Sonuçları göster
            document.getElementById('nominalReturn').textContent = formatCurrency(nominalReturn);
            document.getElementById('nominalReturnRate').textContent = nominalReturnRate.toFixed(2) + '%';
            document.getElementById('annualReturnRate').textContent = annualReturnRate.toFixed(2) + '%';
            document.getElementById('realReturn').textContent = formatCurrency(realReturn);
            document.getElementById('realReturnRate').textContent = realReturnRate.toFixed(2) + '%';
            document.getElementById('purchasingPower').textContent = realReturnRate.toFixed(2) + '%';
            
            // Grafikleri oluştur
            createReturnChart(initialPriceVal, finalPriceVal, realReturn, stopajToggleVal, stopajTutari, netGetiri);
            
            debugLog(`Getiri hesaplandı: Nominal Getiri: ${nominalReturn.toFixed(2)} TL, Reel Getiri: ${realReturn.toFixed(2)} TL`);
        }

        // Getiri grafiğini oluştur
        function createReturnChart(initialPrice, finalPrice, realReturn, stopajToggle, stopajTutari, netGetiri) {
            debugLog('Getiri grafiği oluşturuluyor...');
            
            const ctx = document.getElementById('returnChart');
            const legendContainer = document.getElementById('stackedLegend');
            
            if (!ctx || !legendContainer) return;
            
            // Önceki grafik varsa destroy et
            if (window.returnChartInstance) {
                window.returnChartInstance.destroy();
            }

            // Legend'ı temizle
            legendContainer.innerHTML = '';

            // Renkler
            const initialColor = '#3498db';
            const finalColor = '#2ecc71';
            const positiveReturnColor = '#f39c12';
            const negativeReturnColor = '#e74c3c';
            const stopajColor = '#9b59b6';

            const isPositiveReturn = realReturn >= 0;
            const totalWithReturn = initialPrice + realReturn;

            // Veri setlerini hazırla - STACKED YAPISI
            let datasets = [];
            let labels = ['İlk Fiyat', 'Son Fiyat', 'As Kazanç'];

            if (stopajToggle && isPositiveReturn) {
                // STOPAJLI VE POZİTİF REEL GETİRİ DURUMU
                datasets = [
                    // İlk Fiyat sütunu
                    {
                        label: 'İlk Fiyat',
                        data: [initialPrice, 0, initialPrice],
                        backgroundColor: initialColor,
                        borderColor: initialColor,
                        borderWidth: 2
                    },
                    // Son Fiyat sütunu
                    {
                        label: 'Son Fiyat',
                        data: [0, finalPrice, 0],
                        backgroundColor: finalColor,
                        borderColor: finalColor,
                        borderWidth: 2
                    },
                    // 3. sütun: Reel Getiri (STACKED - İlk Fiyat'ın üstüne ekleniyor)
                    {
                        label: 'Reel Getiri (Stopaj Sonrası)',
                        data: [0, 0, realReturn],
                        backgroundColor: positiveReturnColor,
                        borderColor: positiveReturnColor,
                        borderWidth: 2
                    }
                ];

                // Legend için stopajlı durum bilgisi
                legendContainer.innerHTML = `
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${initialColor}; border-radius: 3px;"></div>
                        <span>İlk Fiyat: ${formatCurrency(initialPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${finalColor}; border-radius: 3px;"></div>
                        <span>Son Fiyat: ${formatCurrency(finalPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${positiveReturnColor}; border-radius: 3px;"></div>
                        <span>Reel Getiri: ${formatCurrency(realReturn)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${stopajColor}; border-radius: 3px;"></div>
                        <span>Stopaj Kesintisi: ${formatCurrency(stopajTutari)}</span>
                    </div>
                    <div class="stacked-legend-item" style="background-color: #e8f5e8;">
                        <strong>As Kazanç (İlk Fiyat + Reel Getiri): ${formatCurrency(totalWithReturn)}</strong>
                    </div>
                `;
            } else if (!stopajToggle && isPositiveReturn) {
                // STOPAJSIZ POZİTİF REEL GETİRİ
                datasets = [
                    // İlk Fiyat sütunu
                    {
                        label: 'İlk Fiyat',
                        data: [initialPrice, 0, initialPrice],
                        backgroundColor: initialColor,
                        borderColor: initialColor,
                        borderWidth: 2
                    },
                    // Son Fiyat sütunu
                    {
                        label: 'Son Fiyat',
                        data: [0, finalPrice, 0],
                        backgroundColor: finalColor,
                        borderColor: finalColor,
                        borderWidth: 2
                    },
                    // 3. sütun: Reel Getiri (STACKED - İlk Fiyat'ın üstüne ekleniyor)
                    {
                        label: 'Reel Getiri',
                        data: [0, 0, realReturn],
                        backgroundColor: positiveReturnColor,
                        borderColor: positiveReturnColor,
                        borderWidth: 2
                    }
                ];

                // Legend için pozitif getiri bilgisi
                legendContainer.innerHTML = `
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${initialColor}; border-radius: 3px;"></div>
                        <span>İlk Fiyat: ${formatCurrency(initialPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${finalColor}; border-radius: 3px;"></div>
                        <span>Son Fiyat: ${formatCurrency(finalPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${positiveReturnColor}; border-radius: 3px;"></div>
                        <span>Reel Getiri: ${formatCurrency(realReturn)}</span>
                    </div>
                    <div class="stacked-legend-item" style="background-color: #e8f5e8;">
                        <strong>As Kazanç (İlk Fiyat + Reel Getiri): ${formatCurrency(totalWithReturn)}</strong>
                    </div>
                `;
            } else {
                // NEGATİF REEL GETİRİ DURUMU (Hem stopajlı hem stopajsız)
                const lossAmount = Math.abs(realReturn);
                const netValue = initialPrice - lossAmount;
                
                datasets = [
                    // İlk Fiyat sütunu
                    {
                        label: 'İlk Fiyat',
                        data: [initialPrice, 0, netValue], // Net değer gösteriliyor
                        backgroundColor: initialColor,
                        borderColor: initialColor,
                        borderWidth: 2
                    },
                    // Son Fiyat sütunu
                    {
                        label: 'Son Fiyat',
                        data: [0, finalPrice, 0],
                        backgroundColor: finalColor,
                        borderColor: finalColor,
                        borderWidth: 2
                    },
                    // 3. sütun: Reel Getiri Kaybı (STACKED - İlk Fiyat'ın üstünde kayıp gösterimi)
                    {
                        label: 'Reel Getiri Kaybı',
                        data: [0, 0, lossAmount],
                        backgroundColor: negativeReturnColor,
                        borderColor: negativeReturnColor,
                        borderWidth: 2
                    }
                ];

                // Legend için negatif getiri bilgisi
                let legendHTML = `
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${initialColor}; border-radius: 3px;"></div>
                        <span>İlk Fiyat: ${formatCurrency(initialPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${finalColor}; border-radius: 3px;"></div>
                        <span>Son Fiyat: ${formatCurrency(finalPrice)}</span>
                    </div>
                    <div class="stacked-legend-item">
                        <div style="width: 15px; height: 15px; background-color: ${negativeReturnColor}; border-radius: 3px;"></div>
                        <span>Reel Getiri Kaybı: ${formatCurrency(lossAmount)}</span>
                    </div>
                `;
                
                if (stopajToggle) {
                    legendHTML += `
                        <div class="stacked-legend-item">
                            <div style="width: 15px; height: 15px; background-color: ${stopajColor}; border-radius: 3px;"></div>
                            <span>Stopaj Kesintisi: ${formatCurrency(stopajTutari)}</span>
                        </div>
                    `;
                }
                
                legendHTML += `
                    <div class="stacked-legend-item" style="background-color: #ffeaea;">
                        <strong>As Kazanç (Net): ${formatCurrency(netValue)}</strong>
                    </div>
                `;
                
                legendContainer.innerHTML = legendHTML;
            }

            window.returnChartInstance = new Chart(ctx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            stacked: true,
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            },
                            title: {
                                display: true,
                                text: 'Tutar (TL)'
                            }
                        },
                        x: {
                            stacked: true,
                            title: {
                                display: true,
                                text: 'Değerler'
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${formatCurrency(context.raw)}`;
                                }
                            }
                        },
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            debugLog('Getiri grafiği oluşturuldu');
        }

        // Para formatı
        function formatCurrency(amount) {
            return new Intl.NumberFormat('tr-TR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount) + ' TL';
        }

        // Tool seçimini ayarla
        function setupToolSelection() {
            const toolItems = document.querySelectorAll('.tool-item');
            toolItems.forEach(item => {
                item.addEventListener('click', function() {
                    const tool = this.dataset.tool;
                    switchTool(tool);
                    
                    // Aktif tool'u vurgula
                    toolItems.forEach(toolItem => {
                        toolItem.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
        }

        // Tool değiştir
        function switchTool(tool) {
            debugLog(`Tool değiştiriliyor: ${tool}`);
            
            // Tüm tool section'ları gizle
            document.querySelectorAll('.tool-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Seçili tool'u göster
            const targetSection = document.getElementById(`${tool}-section`);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            state.currentTool = tool;
            
            // Getiri tool'una geçildiğinde grafiği yeniden render et
            if (tool === 'getiri') {
                setTimeout(() => {
                    calculateInvestmentReturn();
                }, 100);
            }
            
            // Enflasyon tool'una geçildiğinde grafiği yeniden render et
            if (tool === 'inflation') {
                setTimeout(() => {
                    renderInflationChart();
                }, 100);
            }
            
            debugLog(`Aktif tool: ${tool}`);
        }

        // Hızlı işlem butonlarını ayarla
        function setupQuickActions() {
            const quickActionBtns = document.querySelectorAll('.quick-action-btn');
            quickActionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const amount = parseFloat(this.dataset.amount);
                    document.getElementById('expenseAmount').value = amount;
                    debugLog(`Hızlı işlem: ${amount} TL seçildi`);
                });
            });
        }

        // Enflasyon grafiğini render et
        function renderInflationChart() {
            debugLog('Enflasyon grafiği oluşturuluyor...');
            
            const ctx = document.getElementById('inflationChart');
            if (!ctx) return;
            
            // Eğer önceki chart varsa destroy et
            if (window.inflationChartInstance) {
                window.inflationChartInstance.destroy();
            }
            
            window.inflationChartInstance = new Chart(ctx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: inflationData.months,
                    datasets: [
                        {
                            label: 'TÜİK',
                            data: inflationData.tuk,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'İTO',
                            data: inflationData.ito,
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'ENAG',
                            data: inflationData.enag,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '2025 Yılı Aylık Enflasyon Karşılaştırması',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: %${context.parsed.y.toFixed(2)}`;
                                }
                            }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Enflasyon Oranı (%)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '%' + value;
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Aylar'
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'nearest'
                    }
                }
            });
            
            debugLog('Enflasyon grafiği oluşturuldu');
        }

        // Kart ekleme modal'ını aç
        function openAddCardModal() {
            debugLog('Kart ekleme modalı açılıyor');
            document.getElementById('addCardModal').classList.add('active');
            document.getElementById('modalCardName').focus();
        }

        // Kart ekleme modal'ını kapat
        function closeAddCardModal() {
            debugLog('Kart ekleme modalı kapatılıyor');
            document.getElementById('addCardModal').classList.remove('active');
            // Formu temizle
            document.getElementById('modalCardName').value = '';
            document.getElementById('modalAsLimit').value = '25000';
            document.getElementById('modalCardLimit').value = '';
        }

        // Kart ekleme onayla
        function confirmAddCard() {
            const cardName = document.getElementById('modalCardName').value.trim();
            const asLimit = parseFloat(document.getElementById('modalAsLimit').value);
            const cardLimit = parseFloat(document.getElementById('modalCardLimit').value);
            
            if (!cardName) {
                alert('Lütfen bir kart adı girin.');
                return;
            }
            
            if (isNaN(asLimit) || asLimit <= 0) {
                alert('Lütfen geçerli bir As Limit değeri girin.');
                return;
            }
            
            if (isNaN(cardLimit) || cardLimit <= 0) {
                alert('Lütfen geçerli bir kart limiti girin.');
                return;
            }
            
            // Yeni kart oluştur
            const newCard = {
                id: Date.now().toString(),
                name: cardName,
                asLimit: asLimit,
                limit: cardLimit,
                availableLimit: cardLimit,
                totalDebt: 0,
                minPayment: 0
            };
            
            // State'e ekle
            state.cards.push(newCard);
            
            // Aktif kartı ayarla
            state.currentCard = newCard;
            state.asLimit = asLimit;
            
            // UI'ı güncelle
            updateUI();
            
            // Modal'ı kapat
            closeAddCardModal();
            
            debugLog(`Yeni kart eklendi: ${cardName}`);
        }

        // UI'ı güncelle
        function updateUI() {
            if (state.currentCard) {
                // Kart bilgilerini güncelle
                document.getElementById('currentCardName').textContent = state.currentCard.name;
                document.getElementById('availableLimit').textContent = formatCurrency(state.currentCard.availableLimit);
                document.getElementById('totalDebt').textContent = formatCurrency(state.currentCard.totalDebt);
                document.getElementById('minPayment').textContent = formatCurrency(state.currentCard.minPayment);
                
                // Limit doluluk çubuğunu güncelle
                const limitPercentage = ((state.currentCard.limit - state.currentCard.availableLimit) / state.currentCard.limit) * 100;
                document.getElementById('limitFill').style.width = `${limitPercentage}%`;
                
                // As limit input'unu güncelle
                document.getElementById('asLimitInput').value = state.asLimit;
                
                // Kart listesini render et
                renderCardList();
                
                // Harcamaları render et
                renderExpenses();
                
                // Aylık ödemeleri render et
                renderMonthColumns();
                
                // Raporu güncelle
                updateTaksitReport();
            } else {
                // Eğer aktif kart yoksa varsayılan değerleri göster
                document.getElementById('currentCardName').textContent = 'Kart Seçin';
                document.getElementById('availableLimit').textContent = formatCurrency(0);
                document.getElementById('totalDebt').textContent = formatCurrency(0);
                document.getElementById('minPayment').textContent = formatCurrency(0);
                document.getElementById('limitFill').style.width = '0%';
                
                // Raporu güncelle
                updateTaksitReport();
            }
        }

        // Kart listesini render et
        function renderCardList() {
            const cardList = document.getElementById('cardList');
            
            if (state.cards.length === 0) {
                cardList.innerHTML = `
                    <div class="empty-state" style="width: 100%; margin-top: 15px;">
                        <i class="fas fa-credit-card"></i>
                        <h3>Henüz kart eklenmemiş</h3>
                        <p>Yukarıdaki "Yeni Kart Ekle" butonuna tıklayarak ilk kartınızı ekleyin</p>
                    </div>
                `;
                return;
            }
            
            cardList.innerHTML = '';
            
            state.cards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = `card-item ${state.currentCard && state.currentCard.id === card.id ? 'active' : ''}`;
                cardElement.innerHTML = `
                    <div class="card-name">${card.name}</div>
                    <div class="card-stats">
                        <span>Limit: ${formatCurrency(card.limit)}</span>
                        <span>Kalan: ${formatCurrency(card.availableLimit)}</span>
                    </div>
                    <button class="card-delete-btn" data-id="${card.id}">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                // Kart seçme event'i
                cardElement.addEventListener('click', function(e) {
                    if (!e.target.classList.contains('card-delete-btn')) {
                        selectCard(card.id);
                    }
                });
                
                // Kart silme butonu
                const deleteBtn = cardElement.querySelector('.card-delete-btn');
                deleteBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    deleteCard(card.id);
                });
                
                cardList.appendChild(cardElement);
            });
        }

        // Kart seç
        function selectCard(cardId) {
            const card = state.cards.find(c => c.id === cardId);
            if (card) {
                state.currentCard = card;
                state.asLimit = card.asLimit;
                updateUI();
                debugLog(`Kart seçildi: ${card.name}`);
            }
        }

        // Kart sil
        function deleteCard(cardId) {
            if (confirm('Bu kartı silmek istediğinizden emin misiniz? Kartla birlikte tüm harcamalar da silinecektir.')) {
                // Kartı state'den kaldır
                state.cards = state.cards.filter(c => c.id !== cardId);
                
                // Eğer silinen kart aktif kart ise, aktif kartı sıfırla
                if (state.currentCard && state.currentCard.id === cardId) {
                    state.currentCard = state.cards.length > 0 ? state.cards[0] : null;
                }
                
                // Eğer aktif kart yoksa, harcamaları temizle
                if (!state.currentCard) {
                    state.expenses = [];
                }
                
                // UI'ı güncelle
                updateUI();
                
                debugLog(`Kart silindi: ${cardId}`);
            }
        }

        // Harcamaları render et
        function renderExpenses() {
            const expenseCards = document.getElementById('expenseCards');
            
            if (!state.currentCard || state.expenses.length === 0) {
                expenseCards.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-receipt"></i>
                        <h3>Henüz harcama eklenmemiş</h3>
                        <p>Yukarıdaki formu kullanarak ilk harcamanızı ekleyin</p>
                    </div>
                `;
                return;
            }
            
            // Sadece aktif karta ait harcamaları göster
            const cardExpenses = state.expenses.filter(expense => expense.cardId === state.currentCard.id);
            
            if (cardExpenses.length === 0) {
                expenseCards.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-receipt"></i>
                        <h3>Henüz harcama eklenmemiş</h3>
                        <p>Yukarıdaki formu kullanarak ilk harcamanızı ekleyin</p>
                    </div>
                `;
                return;
            }
            
            expenseCards.innerHTML = '';
            
            cardExpenses.forEach(expense => {
                const expenseCard = document.createElement('div');
                expenseCard.className = 'expense-card';
                expenseCard.innerHTML = `
                    <div class="expense-card-header">
                        <div class="expense-name">${expense.name}</div>
                        <button class="delete-btn" data-id="${expense.id}">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="expense-details">
                        <p>
                            <span class="label">Tutar:</span>
                            <span class="value">${formatCurrency(expense.amount)}</span>
                        </p>
                        <p>
                            <span class="label">Taksit:</span>
                            <span class="value">${expense.installmentCount} ay</span>
                        </p>
                        <p>
                            <span class="label">Toplam:</span>
                            <span class="value">${formatCurrency(expense.totalAmount)}</span>
                        </p>
                    </div>
                `;
                
                // Silme butonu event'i
                const deleteBtn = expenseCard.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', function() {
                    deleteExpense(expense.id);
                });
                
                expenseCards.appendChild(expenseCard);
            });
        }

        // Harcama ekle
        function addExpense() {
            if (!state.currentCard) {
                alert('Lütfen önce bir kart seçin.');
                return;
            }
            
            const expenseName = document.getElementById('expenseName').value.trim();
            const expenseAmount = parseFloat(document.getElementById('expenseAmount').value);
            const installmentCount = parseInt(document.getElementById('installmentCount').value);
            
            if (!expenseName) {
                alert('Lütfen bir harcama adı girin.');
                return;
            }
            
            if (isNaN(expenseAmount) || expenseAmount <= 0) {
                alert('Lütfen geçerli bir harcama tutarı girin.');
                return;
            }
            
            if (isNaN(installmentCount) || installmentCount < 1) {
                alert('Lütfen geçerli bir taksit sayısı girin.');
                return;
            }
            
            // Yeni harcama oluştur - Aylık ödeme artık hesaplanmıyor
            const newExpense = {
                id: Date.now().toString(),
                cardId: state.currentCard.id,
                name: expenseName,
                amount: expenseAmount,
                installmentCount: installmentCount,
                totalAmount: expenseAmount, // Toplam tutar harcama tutarına eşit
                date: new Date()
            };
            
            // State'e ekle
            state.expenses.push(newExpense);
            
            // Kart bilgilerini güncelle
            updateCardCalculations();
            
            // UI'ı güncelle
            updateUI();
            
            debugLog(`Harcama eklendi: ${expenseName} - ${expenseAmount} TL - ${installmentCount} taksit`);
        }

        // Harcama sil
        function deleteExpense(expenseId) {
            if (confirm('Bu harcamayı silmek istediğinizden emin misiniz?')) {
                // Harcamayı state'den kaldır
                state.expenses = state.expenses.filter(expense => expense.id !== expenseId);
                
                // Kart bilgilerini güncelle
                updateCardCalculations();
                
                // UI'ı güncelle
                updateUI();
                
                debugLog(`Harcama silindi: ${expenseId}`);
            }
        }

        // Kart hesaplamalarını güncelle
        function updateCardCalculations() {
            if (!state.currentCard) return;
            
            // Aktif karta ait harcamaları filtrele
            const cardExpenses = state.expenses.filter(expense => expense.cardId === state.currentCard.id);
            
            // Toplam borç hesapla
            const totalDebt = cardExpenses.reduce((sum, expense) => sum + expense.amount, 0);
            
            // Kullanılabilir limit hesapla
            const availableLimit = state.currentCard.limit - totalDebt;
            
            // Asgari ödeme hesapla (basitçe toplam borcun %20'si olarak)
            const minPayment = totalDebt * 0.2;
            
            // Kart bilgilerini güncelle
            state.currentCard.totalDebt = totalDebt;
            state.currentCard.availableLimit = availableLimit;
            state.currentCard.minPayment = minPayment;
            
            // Aylık ödemeleri hesapla
            calculateMonthlyPayments();
        }

        // Aylık ödemeleri hesapla
        function calculateMonthlyPayments() {
            if (!state.currentCard) return;
            
            // Aktif karta ait harcamaları filtrele
            const cardExpenses = state.expenses.filter(expense => expense.cardId === state.currentCard.id);
            
            // Ayları oluştur
            generateMonths();
            
            // Aylık ödemeleri sıfırla
            state.payments = state.months.map(month => ({
                month: month,
                total: 0,
                expenses: []
            }));
            
            // Her harcamayı aylara dağıt - TAM TUTAR OLARAK
            cardExpenses.forEach(expense => {
                for (let i = 0; i < expense.installmentCount; i++) {
                    const paymentMonthIndex = i;
                    if (paymentMonthIndex < state.payments.length) {
                        // Her ay için tam harcama tutarını ekle
                        state.payments[paymentMonthIndex].total += expense.amount;
                        state.payments[paymentMonthIndex].expenses.push({
                            name: expense.name,
                            amount: expense.amount
                        });
                    }
                }
            });
        }

        // Ayları oluştur
        function generateMonths() {
            const today = new Date();
            state.months = [];
            
            for (let i = 0; i < 12; i++) {
                const monthDate = new Date(today.getFullYear(), today.getMonth() + i, 1);
                const monthName = monthNames[monthDate.getMonth()];
                const year = monthDate.getFullYear();
                state.months.push(`${monthName} ${year}`);
            }
        }

        // Ay sütunlarını render et
        function renderMonthColumns() {
            const monthsContainer = document.getElementById('monthsContainer');
            const monthRange = document.getElementById('monthRange');
            
            if (!state.currentCard || state.expenses.length === 0) {
                monthsContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <h3>Henüz harcama eklenmemiş</h3>
                        <p>Harcama ekleyin ve aylara dağıtılsın</p>
                    </div>
                `;
                monthRange.textContent = 'Aylar 1-6';
                return;
            }
            
            // Görüntülenecek ayları belirle
            const startIndex = state.currentMonthIndex;
            const endIndex = Math.min(startIndex + state.monthsPerView, state.payments.length);
            const displayMonths = state.payments.slice(startIndex, endIndex);
            
            // Ay aralığını güncelle
            monthRange.textContent = `Aylar ${startIndex + 1}-${endIndex}`;
            
            monthsContainer.innerHTML = '';
            
            displayMonths.forEach(monthData => {
                const monthColumn = document.createElement('div');
                monthColumn.className = 'month-column';
                monthColumn.innerHTML = `
                    <div class="month-header">${monthData.month}</div>
                    <div class="month-expenses">
                        ${monthData.expenses.map(expense => `
                            <div class="expense-item">
                                <div class="expense-item-header">
                                    <div class="expense-name">${expense.name}</div>
                                    <div class="expense-amount">${formatCurrency(expense.amount)}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="month-total">Toplam: ${formatCurrency(monthData.total)}</div>
                `;
                
                monthsContainer.appendChild(monthColumn);
            });
        }

        // Taksit raporunu güncelle
        function updateTaksitReport() {
            if (!state.currentCard) return;
            
            // Aktif karta ait harcamaları filtrele
            const cardExpenses = state.expenses.filter(expense => expense.cardId === state.currentCard.id);
            
            // Rapor özetini güncelle
            updateReportSummary(cardExpenses);
            
            // Rapor tablosunu güncelle
            updateReportTable(cardExpenses);
        }
        
        // Rapor özetini güncelle
        function updateReportSummary(expenses) {
            const summaryContainer = document.getElementById('taksitReportSummary');
            
            if (expenses.length === 0) {
                summaryContainer.innerHTML = `
                    <div class="empty-state" style="width: 100%;">
                        <i class="fas fa-receipt"></i>
                        <h3>Henüz harcama eklenmemiş</h3>
                        <p>Rapor oluşturmak için harcama ekleyin</p>
                    </div>
                `;
                return;
            }
            
            // Toplam hesaplamalar
            const totalExpenses = expenses.reduce((sum, expense) => sum + expense.amount, 0);
            const totalInstallments = expenses.reduce((sum, expense) => sum + expense.installmentCount, 0);
            
            summaryContainer.innerHTML = `
                <div class="report-summary-item">
                    <div class="report-summary-label">Toplam Harcama</div>
                    <div class="report-summary-value">${formatCurrency(totalExpenses)}</div>
                </div>
                <div class="report-summary-item">
                    <div class="report-summary-label">Toplam Taksit</div>
                    <div class="report-summary-value">${totalInstallments}</div>
                </div>
                <div class="report-summary-item">
                    <div class="report-summary-label">Toplam Harcama Sayısı</div>
                    <div class="report-summary-value">${expenses.length}</div>
                </div>
            `;
        }
        
        // Rapor tablosunu güncelle
        function updateReportTable(expenses) {
            const tableBody = document.querySelector('#taksitReportTable tbody');
            
            if (expenses.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 20px;">
                            <i class="fas fa-info-circle"></i> Henüz harcama eklenmemiş
                        </td>
                    </tr>
                `;
                return;
            }
            
            tableBody.innerHTML = '';
            
            expenses.forEach(expense => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${expense.name}</td>
                    <td>${formatCurrency(expense.amount)}</td>
                    <td>${expense.installmentCount} ay</td>
                    <td>${formatCurrency(expense.totalAmount)}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // PDF raporu oluştur
        function generatePdfReport() {
            if (!state.currentCard) {
                alert('Lütfen önce bir kart seçin.');
                return;
            }
            
            const cardExpenses = state.expenses.filter(expense => expense.cardId === state.currentCard.id);
            
            if (cardExpenses.length === 0) {
                alert('Rapor oluşturmak için harcama ekleyin.');
                return;
            }
            
            // PDF oluştur
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Başlık
            doc.setFontSize(20);
            doc.setTextColor(44, 62, 80);
            doc.text('Taksitify - Taksit Raporu', 20, 30);
            
            // Tarih
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            doc.text(`Oluşturulma Tarihi: ${new Date().toLocaleDateString('tr-TR')}`, 20, 45);
            
            // Kart bilgileri
            doc.setFontSize(14);
            doc.setTextColor(44, 62, 80);
            doc.text(`Kart: ${state.currentCard.name}`, 20, 65);
            doc.text(`Limit: ${formatCurrency(state.currentCard.limit)}`, 20, 80);
            doc.text(`Kalan Limit: ${formatCurrency(state.currentCard.availableLimit)}`, 20, 95);
            
            // Özet bilgiler
            const totalExpenses = cardExpenses.reduce((sum, expense) => sum + expense.amount, 0);
            const totalInstallments = cardExpenses.reduce((sum, expense) => sum + expense.installmentCount, 0);
            
            doc.text(`Toplam Harcama: ${formatCurrency(totalExpenses)}`, 120, 65);
            doc.text(`Toplam Taksit: ${totalInstallments}`, 120, 80);
            doc.text(`Asgari Ödeme: ${formatCurrency(state.currentCard.minPayment)}`, 120, 95);
            
            // Tablo başlığı
            doc.setFontSize(16);
            doc.text('Harcama Detayları', 20, 120);
            
            // Tablo verileri
            const tableData = cardExpenses.map(expense => [
                expense.name,
                formatCurrency(expense.amount),
                `${expense.installmentCount} ay`,
                formatCurrency(expense.totalAmount)
            ]);
            
            // Tablo oluştur
            doc.autoTable({
                startY: 130,
                head: [['Harcama Adı', 'Tutar', 'Taksit', 'Toplam']],
                body: tableData,
                theme: 'grid',
                styles: { fontSize: 10 },
                headStyles: { fillColor: [52, 152, 219] }
            });
            
            // Aylık ödemeler tablosu
            const finalY = doc.lastAutoTable.finalY + 20;
            doc.setFontSize(16);
            doc.text('Aylık Ödeme Planı', 20, finalY);
            
            const monthlyData = state.payments.map((payment, index) => [
                payment.month,
                formatCurrency(payment.total),
                payment.expenses.length
            ]);
            
            doc.autoTable({
                startY: finalY + 10,
                head: [['Ay', 'Toplam Ödeme', 'Harcama Sayısı']],
                body: monthlyData,
                theme: 'grid',
                styles: { fontSize: 10 },
                headStyles: { fillColor: [46, 204, 113] }
            });
            
            // PDF'i indir
            doc.save(`Taksitify_Rapor_${state.currentCard.name}_${new Date().toISOString().slice(0, 10)}.pdf`);
            
            debugLog('PDF raporu oluşturuldu ve indirildi');
        }
        
        // Excel raporu oluştur
        function generateExcelReport() {
            if (!state.currentCard) {
                alert('Lütfen önce bir kart seçin.');
                return;
            }
            
            const cardExpenses = state.expenses.filter(expense => expense.cardId === state.currentCard.id);
            
            if (cardExpenses.length === 0) {
                alert('Rapor oluşturmak için harcama ekleyin.');
                return;
            }
            
            // Excel çalışma kitabı oluştur
            const wb = XLSX.utils.book_new();
            wb.Props = {
                Title: "Taksitify Taksit Raporu",
                Subject: "Taksit Hesaplama Raporu",
                Author: "Taksitify",
                CreatedDate: new Date()
            };
            
            // Harcama detayları sayfası
            const expenseData = [
                ['Harcama Adı', 'Tutar', 'Taksit Sayısı', 'Toplam Tutar'],
                ...cardExpenses.map(expense => [
                    expense.name,
                    expense.amount,
                    expense.installmentCount,
                    expense.totalAmount
                ])
            ];
            
            const expenseSheet = XLSX.utils.aoa_to_sheet(expenseData);
            XLSX.utils.book_append_sheet(wb, expenseSheet, "Harcama Detayları");
            
            // Aylık ödemeler sayfası
            const monthlyData = [
                ['Ay', 'Toplam Ödeme', 'Harcama Sayısı'],
                ...state.payments.map(payment => [
                    payment.month,
                    payment.total,
                    payment.expenses.length
                ])
            ];
            
            const monthlySheet = XLSX.utils.aoa_to_sheet(monthlyData);
            XLSX.utils.book_append_sheet(wb, monthlySheet, "Aylık Ödemeler");
            
            // Özet sayfası
            const totalExpenses = cardExpenses.reduce((sum, expense) => sum + expense.amount, 0);
            const totalInstallments = cardExpenses.reduce((sum, expense) => sum + expense.installmentCount, 0);
            
            const summaryData = [
                ['Kart Bilgileri', ''],
                ['Kart Adı', state.currentCard.name],
                ['Limit', state.currentCard.limit],
                ['Kalan Limit', state.currentCard.availableLimit],
                ['Toplam Borç', state.currentCard.totalDebt],
                ['Asgari Ödeme', state.currentCard.minPayment],
                ['', ''],
                ['Özet Bilgiler', ''],
                ['Toplam Harcama', totalExpenses],
                ['Toplam Taksit', totalInstallments],
                ['Harcama Sayısı', cardExpenses.length],
                ['', ''],
                ['Rapor Tarihi', new Date().toLocaleDateString('tr-TR')]
            ];
            
            const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, summarySheet, "Özet");
            
            // Excel dosyasını indir
            XLSX.writeFile(wb, `Taksitify_Rapor_${state.currentCard.name}_${new Date().toISOString().slice(0, 10)}.xlsx`);
            
            debugLog('Excel raporu oluşturuldu ve indirildi');
        }
    </script>
</body>
</html>
